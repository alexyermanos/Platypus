<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Database lookup • Platypus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Database lookup">
<meta property="og:description" content="Platypus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Get started</a>
</li>
<li>
  <a href="../vignette_index.html">Vignettes</a>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://immunesim.readthedocs.io/en/latest/" class="external-link">ImmuneSIM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/alexyermanos" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Database lookup</h1>
                        <h4 data-toc-skip class="author">Tudor-Stefan
Cotet, Andreas Agrafiotis, Alexander Yermanos</h4>
            
            <h4 data-toc-skip class="date">09/06/2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alexyermanos/Platypus/tree/mastervignettes/DB%20lookup.Rmd" class="external-link"><code>vignettes/DB lookup.Rmd</code></a></small>
      <div class="hidden name"><code>DB lookup.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1 Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Platypus family of packages are meant to provide potential
pipelines and examples relevant to the broad field of computational
immunology. The core set of functions can be found at <a href="https://github.com/alexyermanos/Platypus" class="external-link uri">https://github.com/alexyermanos/Platypus</a> and examples of
use can be found in the publications <a href="https://doi.org/10.1093/nargab/lqab023" class="external-link uri">https://doi.org/10.1093/nargab/lqab023</a> and
<strong>insert biorxiv database manuscript here</strong></p>
<p>Stay tuned for updates <a href="https://twitter.com/AlexYermanos" class="external-link uri">https://twitter.com/AlexYermanos</a></p>
<p>To allow for thorough annotation of immune receptor sequence data,
the Platypus ecosystem includes functions for database loading,
processing, and annotation of both TCRs and BCRs. The currently
supported databases are VDJdb, McPAS-TCR, and TBAdb.</p>
</div>
<div class="section level2">
<h2 id="loading-the-vgm">2. Loading the VGM<a class="anchor" aria-label="anchor" href="#loading-the-vgm"></a>
</h2>
<p>The output of the VDJ_GEX_matrix is the main object for all
downstream functions in Platypus. We can create this directly into the R
session by using the public data available on PlatypusDB. We will use
the VDJ data of CD8+ T cells from several murine models of acute,
chronic, and latent viral infections.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Platypus</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#source('VDJ_antigen_integrate.R')</span></span>
<span><span class="co">#source('VDJ_db_load.R')</span></span>
<span><span class="co">#source('VDJ_db_annotate.R')</span></span>
<span></span>
<span><span class="fu"><a href="../reference/PlatypusDB_fetch.html">PlatypusDB_fetch</a></span><span class="op">(</span>PlatypusDB.links <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kuhn2021a//VDJmatrix"</span><span class="op">)</span>, </span>
<span>                                     load.to.enviroment <span class="op">=</span> <span class="cn">T</span>, combine.objects <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2022-08-07 19:40:02: Starting download of kuhn2021a__VDJmatrix.RData...</span></span></code></pre>
<pre><code><span><span class="co">## [1] "kuhn2021a__VDJmatrix"</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VDJ</span> <span class="op">&lt;-</span> <span class="va">kuhn2021a__VDJmatrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vdj_db_load-for-loading-the-specified-databases">3. VDJ_db_load for loading the specified databases<a class="anchor" aria-label="anchor" href="#vdj_db_load-for-loading-the-specified-databases"></a>
</h2>
<p>The currently supported databases include VDJdb (<a href="https://vdjdb.cdr3.net" class="external-link uri">https://vdjdb.cdr3.net</a>),
McPAS-TCR (<a href="http://friedmanlab.weizmann.ac.il/McPAS-TCR/" class="external-link uri">http://friedmanlab.weizmann.ac.il/McPAS-TCR/</a>), and the
PIRD TBAdb (<a href="https://doi.org/10.1093/bioinformatics/btz614" class="external-link uri">https://doi.org/10.1093/bioinformatics/btz614</a>). We will
showcase how to load, process, and filter VDJdb using the VDJ_db_load
function.</p>
<p>Loading the necessary database can be controlled via the databases
parameter: “vdjdb” for VDJdb, “mcpas” for McPAS-TCR, “tbadb-bcr” for the
BCR subset of TBAdb, “tbdadb-tcr” for the TCR subset.</p>
<p>The database csv files will be automatically downloaded from their
respective website. However, if this is not working, it is recommended
to input the paths to the locally downloaded databases in the file.paths
parameter.</p>
<p>Multiple databases can be loaded and processed concurrently by
grouping them in a list (e.g., databases = list(“vdjdb”, “mcpas”)).</p>
<p>If preprocess is set to T, the database will be processed as follows:
1. species will be filtered as either ‘Human’ or ‘Mouse’, as specified
in the species paramater; 2.rows with NA values will be removed
depending on the filter.sequences argument (‘VDJ’ will only remove rows
with NA VDJ sequences, ‘VJ’ for VJ sequences, and ‘VDJ.VJ’ for both); 3.
remove.na implements additional strategies to remove NA values (‘all’
removes all rows with a single NA value, ‘common’ will only remove rows
with NA values in the columns shared with the other databases - useful
when processing a list of databases, and ‘vgm’ will remove based on the
common columns in the VDJ and the respective database);
4.keep.only.common will keep the common columns across all 3 supported
databases - ‘VJ_cdr3s_aa’,‘VDJ_cdr3s_aa’,‘Species’,‘Epitope’,‘Antigen
species’.</p>
<p>If preprocess is set to F, then the raw database will be loaded/
saved as a CSV file (if output.format is set to ‘save’).</p>
<p>We will load the VDJdb with preprocess set to T and with the default
processing arguments.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_db_load.html">VDJ_db_load</a></span><span class="op">(</span>databases <span class="op">=</span> <span class="st">'vdjdb'</span>,</span>
<span>                  preprocess <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                  species <span class="op">=</span> <span class="st">'Mouse'</span>,</span>
<span>                  filter.sequences <span class="op">=</span> <span class="st">'VDJ.VJ'</span>,</span>
<span>                  remove.na <span class="op">=</span> <span class="st">'common'</span>,</span>
<span>                  keep.only.common <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "vdjdb"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "list"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="vdj_db_annotate-for-annotating-your-vdj-dataframe">4. VDJ_db_annotate for annotating your VDJ dataframe:<a class="anchor" aria-label="anchor" href="#vdj_db_annotate-for-annotating-your-vdj-dataframe"></a>
</h2>
<p>Next, we will use VDJ_db_annotate to add the epitope information from
VDJdb into our VDJ. To do so, we will match the epitope annotations by
CDR3s. Currently, VDJ_db_annotate supports two sequence matching
methods: exact sequence matching and homology matching as determined by
a homology threshold.</p>
<p>VDJ_db_annotate takes as input a list of databases/paths to local CSV
files and the VDJ. We can select the annotation features via the
database.features parameter, which should be a column name present in
all of the databases in the list (e.g., ‘Epitope’).</p>
<p>We will select match = ‘cdr3.aa’ to match by CDR3 sequences and
homology = F for exact matching</p>
<div class="section level3">
<h3 id="exact-feature-matching">1. Exact feature matching<a class="anchor" aria-label="anchor" href="#exact-feature-matching"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotated_VDJ_exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_db_annotate.html">VDJ_db_annotate</a></span><span class="op">(</span>VDJ <span class="op">=</span> <span class="va">VDJ</span>,</span>
<span>                                 db.list <span class="op">=</span> <span class="va">db</span>,</span>
<span>                                 database.features <span class="op">=</span> <span class="st">'Epitope'</span>,</span>
<span>                                 match <span class="op">=</span> <span class="st">'cdr3.aa'</span>,</span>
<span>                                 homology <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Windows system detected</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">annotated_VDJ_exact</span><span class="op">$</span><span class="va">vdjdb_Epitope</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NA          "KAVYNFATC" "HGIRNASFI" "SSPPMFRV"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="homology-feature-matching">2. Homology feature matching<a class="anchor" aria-label="anchor" href="#homology-feature-matching"></a>
</h3>
<p>We can do homology matching by setting homology to TRUE and a
specific Levenshtein distance threshold (via the lv.distance
parameter).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotated_VDJ_homology1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_db_annotate.html">VDJ_db_annotate</a></span><span class="op">(</span>VDJ <span class="op">=</span> <span class="va">VDJ</span>,</span>
<span>                                 db.list <span class="op">=</span> <span class="va">db</span>,</span>
<span>                                 database.features <span class="op">=</span> <span class="st">'Epitope'</span>,</span>
<span>                                 match <span class="op">=</span> <span class="st">'cdr3.aa'</span>,</span>
<span>                                 homology <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                 lv.distance <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Windows system detected</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">annotated_VDJ_homology1</span><span class="op">$</span><span class="va">vdjdb_Epitope</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "KAVYNFATC"                                                      </span></span>
<span><span class="co">## [2] NA                                                               </span></span>
<span><span class="co">## [3] "SSPPMFRV;HGIRNASFI;SSPPMFRV;SSPPMFRV;SSPPMFRV;SSPPMFRV;SSPPMFRV"</span></span>
<span><span class="co">## [4] "HGIRNASFI"                                                      </span></span>
<span><span class="co">## [5] "SSPPMFRV"                                                       </span></span>
<span><span class="co">## [6] "HGIRNASFI;HGIRNASFI;HGIRNASFI;HGIRNASFI"</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotated_VDJ_homology5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_db_annotate.html">VDJ_db_annotate</a></span><span class="op">(</span>VDJ <span class="op">=</span> <span class="va">VDJ</span>,</span>
<span>                                 db.list <span class="op">=</span> <span class="va">db</span>,</span>
<span>                                 database.features <span class="op">=</span> <span class="st">'Epitope'</span>,</span>
<span>                                 match <span class="op">=</span> <span class="st">'cdr3.aa'</span>,</span>
<span>                                 homology <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                 lv.distance <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Windows system detected</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">annotated_VDJ_homology5</span><span class="op">$</span><span class="va">vdjdb_Epitope</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">##  [2] NA                                                                                                                                                                                                                                                                                                                                                                                                       </span></span>
<span><span class="co">##  [3] "KAVYNFATC;KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">##  [4] "KAVANFATM;KAPANFATM;KAPFNFATM;KAPYNFATM;KAVYNFATM;KAPYDYAPI"                                                                                                                                                                                                                                                                                                                                            </span></span>
<span><span class="co">##  [5] "SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">##  [6] "TVYGFCLL;TVYGFCLL"                                                                                                                                                                                                                                                                                                                                                                                      </span></span>
<span><span class="co">##  [7] "SSPPMFRV"                                                                                                                                                                                                                                                                                                                                                                                               </span></span>
<span><span class="co">##  [8] "HGIRNASFI"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">##  [9] "KAVYNFATC;KAVYNFATC;KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                          </span></span>
<span><span class="co">## [10] "SSLENFRAYV"                                                                                                                                                                                                                                                                                                                                                                                             </span></span>
<span><span class="co">## [11] "ASNENMETM"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">## [12] "LSLRNPILV"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">## [13] "ASNENMETM;TVYGFCLL"                                                                                                                                                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">## [14] "LSLRNPILV;SSLENFRAYV"                                                                                                                                                                                                                                                                                                                                                                                   </span></span>
<span><span class="co">## [15] "SSPPMFRV;HGIRNASFI"                                                                                                                                                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">## [16] "SSYRRPVGI;ASNENMETM;ASNENMETM;ASNENMETM"                                                                                                                                                                                                                                                                                                                                                                </span></span>
<span><span class="co">## [17] "SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                                      </span></span>
<span><span class="co">## [18] "SSYRRPVGI;SSYRRPVGI;SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                                                          </span></span>
<span><span class="co">## [19] "SSYRRPVGI;KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [20] "VVGAVGVGK"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">## [21] "LSLRNPILV;LSLRNPILV"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [22] "ASNENMETM;KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [23] "SSYRRPVGI;SSYRRPVGI;SSLENFRAYV;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSLENFRAYV;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI"</span></span>
<span><span class="co">## [24] "SSYRRPVGI;SSLENFRAYV;SSLENFRAYV"                                                                                                                                                                                                                                                                                                                                                                        </span></span>
<span><span class="co">## [25] "SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV"                                                                                                                                                                                                                                                                                                                                                 </span></span>
<span><span class="co">## [26] "ASNENMETM;ASNENMETM"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [27] "SSLENFRAYV;SSLENFRAYV"                                                                                                                                                                                                                                                                                                                                                                                  </span></span>
<span><span class="co">## [28] "SSYRRPVGI;SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [29] "SSYRRPVGI;SSLENFRAYV;SSLENFRAYV;SSYRRPVGI;SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                                    </span></span>
<span><span class="co">## [30] "SSLENFRAYV;SSLENFRAYV;SSYRRPVGI;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;LSLRNPILV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV;SSLENFRAYV"                                                                                                                                                                                                               </span></span>
<span><span class="co">## [31] "SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI;SSYRRPVGI"                                                                                                                                                                                                                                                                                                                                            </span></span>
<span><span class="co">## [32] "TVYGFCLL"                                                                                                                                                                                                                                                                                                                                                                                               </span></span>
<span><span class="co">## [33] "SQLLNAKYL"                                                                                                                                                                                                                                                                                                                                                                                              </span></span>
<span><span class="co">## [34] "LSLRNPILV;SSYRRPVGI;LSLRNPILV;KAVYNFATC"                                                                                                                                                                                                                                                                                                                                                                </span></span>
<span><span class="co">## [35] "SSPPMFRV;HGIRNASFI;SSPPMFRV;SSPPMFRV;SSPPMFRV;SSPPMFRV;SSPPMFRV"                                                                                                                                                                                                                                                                                                                                        </span></span>
<span><span class="co">## [36] "KAVANFATM;KAPANFATM;KAPFNFATM;KAPYNFATM;KAVYNFATM;KAPYDYAPI;ASNENMETM;KAVYNFATC"                                                                                                                                                                                                                                                                                                                        </span></span>
<span><span class="co">## [37] "HGIRNASFI;HGIRNASFI;HGIRNASFI;HGIRNASFI"                                                                                                                                                                                                                                                                                                                                                                </span></span>
<span><span class="co">## [38] "HGIRNASFI;HGIRNASFI"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-epitope-annotations-via-vdj_abundances">5. Visualizing epitope annotations via VDJ_abundances<a class="anchor" aria-label="anchor" href="#visualizing-epitope-annotations-via-vdj_abundances"></a>
</h2>
<p>We will use VDJ_abundaces o obtain the number of cells annotated with
each epitope, using the exact and homology matching from above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_abundances.html">VDJ_abundances</a></span><span class="op">(</span><span class="va">annotated_VDJ_exact</span>, </span>
<span>                     feature.columns <span class="op">=</span> <span class="st">'vdjdb_Epitope'</span>, </span>
<span>                     grouping.column <span class="op">=</span> <span class="st">'sample_id'</span>, </span>
<span>                     sample.column <span class="op">=</span> <span class="st">'none'</span>, </span>
<span>                     output.format <span class="op">=</span> <span class="st">'barplot'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_abundances.html">VDJ_abundances</a></span><span class="op">(</span><span class="va">annotated_VDJ_homology1</span>, </span>
<span>                     feature.columns <span class="op">=</span> <span class="st">'vdjdb_Epitope'</span>, </span>
<span>                     grouping.column <span class="op">=</span> <span class="st">'sample_id'</span>, </span>
<span>                     sample.column <span class="op">=</span> <span class="st">'none'</span>, </span>
<span>                     output.format <span class="op">=</span> <span class="st">'barplot'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_abundances.html">VDJ_abundances</a></span><span class="op">(</span><span class="va">annotated_VDJ_homology5</span>, </span>
<span>                     feature.columns <span class="op">=</span> <span class="st">'vdjdb_Epitope'</span>, </span>
<span>                     grouping.column <span class="op">=</span> <span class="st">'sample_id'</span>, </span>
<span>                     sample.column <span class="op">=</span> <span class="st">'none'</span>, </span>
<span>                     output.format <span class="op">=</span> <span class="st">'barplot'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Exact matching</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="DB%20lookup_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Homology matching threshold = 1</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="DB%20lookup_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Homology matching threshold = 5</span></span>
<span><span class="va">p3</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="DB%20lookup_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="version-information">6. Version information<a class="anchor" aria-label="anchor" href="#version-information"></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23 ucrt)</span></span>
<span><span class="co">## Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">## Running under: Windows 10 x64 (build 19044)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] LC_COLLATE=German_Germany.utf8  LC_CTYPE=German_Germany.utf8   </span></span>
<span><span class="co">## [3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   </span></span>
<span><span class="co">## [5] LC_TIME=German_Germany.utf8    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] Platypus_3.4.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] stringdist_0.9.8   Rcpp_1.0.9         ape_5.6-2          lattice_0.20-45   </span></span>
<span><span class="co">##  [5] tidyr_1.2.0        assertthat_0.2.1   rprojroot_2.0.3    digest_0.6.29     </span></span>
<span><span class="co">##  [9] foreach_1.5.2      utf8_1.2.2         R6_2.5.1           evaluate_0.15     </span></span>
<span><span class="co">## [13] highr_0.9          ggplot2_3.3.6      pillar_1.8.0       ggfun_0.0.6       </span></span>
<span><span class="co">## [17] yulab.utils_0.0.5  rlang_1.0.4        lazyeval_0.2.2     rstudioapi_0.13   </span></span>
<span><span class="co">## [21] jquerylib_0.1.4    rmarkdown_2.14     pkgdown_2.0.6      labeling_0.4.2    </span></span>
<span><span class="co">## [25] textshaping_0.3.6  desc_1.4.1         stringr_1.4.0      munsell_0.5.0     </span></span>
<span><span class="co">## [29] compiler_4.2.1     xfun_0.31          pkgconfig_2.0.3    systemfonts_1.0.4 </span></span>
<span><span class="co">## [33] gridGraphics_0.5-1 htmltools_0.5.3    tidyselect_1.1.2   tibble_3.1.8      </span></span>
<span><span class="co">## [37] codetools_0.2-18   fansi_1.0.3        dplyr_1.0.9        grid_4.2.1        </span></span>
<span><span class="co">## [41] nlme_3.1-157       jsonlite_1.8.0     gtable_0.3.0       lifecycle_1.0.1   </span></span>
<span><span class="co">## [45] DBI_1.1.3          magrittr_2.0.3     scales_1.2.0       tidytree_0.3.9    </span></span>
<span><span class="co">## [49] cli_3.3.0          stringi_1.7.8      cachem_1.0.6       farver_2.1.1      </span></span>
<span><span class="co">## [53] fs_1.5.2           doParallel_1.0.17  ggtree_3.4.1       bslib_0.4.0       </span></span>
<span><span class="co">## [57] ellipsis_0.3.2     ragg_1.2.2         generics_0.1.3     vctrs_0.4.1       </span></span>
<span><span class="co">## [61] iterators_1.0.14   tools_4.2.1        treeio_1.20.1      ggplotify_0.1.0   </span></span>
<span><span class="co">## [65] glue_1.6.2         purrr_0.3.4        parallel_4.2.1     fastmap_1.1.0     </span></span>
<span><span class="co">## [69] yaml_2.3.5         colorspace_2.0-3   aplot_0.1.6        memoise_2.0.1     </span></span>
<span><span class="co">## [73] knitr_1.39         patchwork_1.1.1    sass_0.4.2</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Yermanos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
