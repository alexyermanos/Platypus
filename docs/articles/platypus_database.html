<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlatypusDB vignette • Platypus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PlatypusDB vignette">
<meta property="og:description" content="Platypus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette_index.html">Get started</a>
</li>
<li>
  <a href="../vignette_index.html">Vignettes</a>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://immunesim.readthedocs.io/en/latest/" class="external-link">ImmuneSIM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/alexyermanos" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PlatypusDB vignette</h1>
                        <h4 data-toc-skip class="author">Alexander
Yermanos, Victor Kreiner, Andreas Agrafiotis</h4>
            
            <h4 data-toc-skip class="date">2022-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alexyermanos/Platypus/tree/mastervignettes/platypus_database.Rmd" class="external-link"><code>vignettes/platypus_database.Rmd</code></a></small>
      <div class="hidden name"><code>platypus_database.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PlatypusDB is a publicly available database for combined gene
expression and immune receptor sequencing datasets. The package Platypus
provides and easy-to-use R interface to source available data, integrate
it with locally saved datasets and comprehensively analyse VDJ and GEX
data. For more information on the analysis function of the Platypus
package please refer to the corresponding vignettes. Here the functions
concerning interaction with the PlatypusDB will be covered.</p>
<p>When using datasets from PlatypusDB please make sure to cite the
source of the dataset as well as PlatypusDB at:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Yermanos A et al. Platypus<span class="sc">:</span> an open<span class="sc">-</span>access software <span class="cf">for</span> integrating lymphocyte single<span class="sc">-</span>cell immune repertoires with transcriptomes. NAR Genomics <span class="fu">Bioinforma</span> (<span class="dv">2021</span>) <span class="dv">3</span><span class="sc">:</span> doi<span class="sc">:</span><span class="fl">10.1093</span><span class="sc">/</span>NARGAB<span class="sc">/</span>LQAB023</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span><span class="er">*</span> DB BioRxiv Citation <span class="sc">**</span><span class="er">*</span> </span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Platypus</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="list-available-datasets">2. List available datasets<a class="anchor" aria-label="anchor" href="#list-available-datasets"></a>
</h2>
<p>For an overview and to read specific information about available
dataset, a list of metadata table can be downloaded.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">projects_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlatypusDB_list_projects.html">PlatypusDB_list_projects</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This is a list of named dataframes. Names correspond to project_ids,
which are later used for downloading files.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">projects_metadata</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "agrafiotis2021a"     "horns2020a"          "khatun2019a"        </span>
<span class="co">##  [4] "kreiner2021a"        "kreiner2021b"        "kuhn2021a"          </span>
<span class="co">##  [7] "mathew2021a"         "merkenschlager2021a" "neumeier2021a"      </span>
<span class="co">## [10] "neumeier2021b"       "sandu2021a"          "shlesinger2022a"    </span>
<span class="co">## [13] "shlesinger2022b"     "shlesinger2022c"     "yermanos2021a"      </span>
<span class="co">## [16] "yermanos2021b"       "yermanos2022a"       "yermanos2022b"      </span>
<span class="co">## [19] "yermanos2022c"       "yewdell2021a"        "yost2019"</span></code></pre>
<p>Use list indexing to view the metadata to get information specific to
these projects and their samples</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">projects_metadata</span><span class="op">[[</span><span class="st">"yermanos2021a"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dataset_info</span></code></pre></div>
<pre><code><span class="co">##      project.id</span>
<span class="co">## 2 yermanos2021a</span>
<span class="co">##                                                                                                                                                                       publication.title</span>
<span class="co">## 2 Single-cell immune repertoire and transcriptome sequencing reveals that clonally expanded and transcriptionally distinct lymphocytes populate the aged central nervous system in mice</span>
<span class="co">##   organism celltype  n</span>
<span class="co">## 2    mouse  T cells 17</span>
<span class="co">##                                                                                                                              authors</span>
<span class="co">## 2 Alexander Yermanos, Daniel Neumeier, Ioana Sandu, Mariana Borsa, Ann Cathrin Waindok, Doron Merkler, Annette Oxeniu, Sai T. Reddy </span>
<span class="co">##         date                                                 journal</span>
<span class="co">## 2 14.02.2021 Proceedings of the Royal Society B: Biological Sciences</span>
<span class="co">##                      doi correspondence.adress</span>
<span class="co">## 2 10.1098/rspb.2020.2793   ayermanos@gmail.com</span></code></pre>
<p>Sample specific information in the table are below</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">projects_metadata</span><span class="op">[[</span><span class="st">"yermanos2021a"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sample_info</span></code></pre></div>
<pre><code><span class="co">##                       sample_id batch_id</span>
<span class="co">## 7     Aged.CNS.pool.3m.Tcell.S1       b1</span>
<span class="co">## 8    Aged.CNS.pool.12m.Tcell.S2       b1</span>
<span class="co">## 9    Aged.CNS.pool.18m.Tcell.S3       b1</span>
<span class="co">## 10 Aged.CNS.single.18m.Tcell.S4       b1</span>
<span class="co">##                                                                  full.name</span>
<span class="co">## 7      T cells from entire brains of pooled 3-month-old C57/BL6j male mice</span>
<span class="co">## 8     T cells from entire brains of pooled 12-month-old C57/BL6j male mice</span>
<span class="co">## 9     T cells from entire brains of pooled 18-month-old C57/BL6j male mice</span>
<span class="co">## 10 T cells from entire brains of a single 18-month-old C57/BL6j male mouse</span>
<span class="co">##                                                            description</span>
<span class="co">## 7   isolated by FACS based on CD3+ and CD4+ or CD8+ surface expression</span>
<span class="co">## 8   isolated by FACS based on CD3+ and CD4+ or CD8+ surface expression</span>
<span class="co">## 9   isolated by FACS based on CD3+ and CD4+ or CD8+ surface expression</span>
<span class="co">## 10  isolated by FACS based on CD3+ and CD4+ or CD8+ surface expression</span></code></pre>
<p>The dataset yermanos2021a contains data from T cells in the CNS of
aged mice. Analysis of this dataset is showcased in the Platypus
Quickstart vignette.</p>
<p>! Note: In some cases, datasets contain GEX and VDJ for both B and T
cells. Because VDJ libraries were prepared and sequenced separately,
these are uploaded as two different projects, with the same GEX dataset.
e.g. yermanos2021a contains T cell VDJ and GEX data across cells, while
yermanos2021b contains B cell VDJ and again GEX data across cells. To
filter out certain celltypes in GEX before clustering, please refer to
the VGM vignette and the parameter “exclude.on.cell.state.marker”</p>
</div>
<div class="section level2">
<h2 id="downloading-data">3 Downloading data<a class="anchor" aria-label="anchor" href="#downloading-data"></a>
</h2>
<p>The PlatypusDB_fetch function allows easy and flexible downloads
using PlatypusDB.links.</p>
<p>The basis for all are PlatypusDB.links, with which any combination of
files can be easily specified They are composes of three section divided
by “/” 1. project_id (Author2019letter, … ) 2. sample_id (s1, s2, s3, …)
-&gt; SEE METADATA 3. filetype (VDJmatrix, GEXmatrix, metadata, VDJ,
GEX)</p>
<p>Any of these components can be substituted with “ALL”. Further
sample_id can be substituted with ““. (See examples below)</p>
</div>
<div class="section level2">
<h2 id="download-raw-data-and-integrate-via-vgm">3.1 Download raw data and integrate via VGM<a class="anchor" aria-label="anchor" href="#download-raw-data-and-integrate-via-vgm"></a>
</h2>
<p>Here we download the raw VDJ and GEX Cellranger output data for
sample 1 and 2 of the dataset yermanos2021a (To download data from all
samples, substitute “s1” with “ALL”)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_for_VGM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlatypusDB_fetch.html">PlatypusDB_fetch</a></span><span class="op">(</span>
                PlatypusDB.links <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yermanos2021a/Aged.CNS.pool.3m.Tcell.S1/ALL"</span>,
                                     <span class="st">"shlesinger2022b/TFH.LCMV.acuteLCMV.10dpi.S1/ALL"</span><span class="op">)</span>,
                save.to.disk <span class="op">=</span> <span class="cn">F</span>, 
                load.to.enviroment <span class="op">=</span> <span class="cn">F</span>, 
                load.to.list <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co">#Now we can process this via the VGM function.</span>
<span class="va">integrated_VGM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_GEX_matrix.html">VDJ_GEX_matrix</a></span><span class="op">(</span>Data.in <span class="op">=</span> <span class="va">data_for_VGM</span>, verbose <span class="op">=</span> <span class="cn">T</span>, 
                          group.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yermanos2021a"</span>,<span class="st">"shlesinger2022b"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "2022-03-15 16:06:35 CET"</span></code></pre>
<pre><code><span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span>

<span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span></code></pre>
<pre><code><span class="co">## [1] "2022-03-15 16:06:35 CET"</span>
<span class="co">## [1] "2022-03-15 16:06:36 CET"</span>
<span class="co">## [1] "2022-03-15 16:06:37 CET"</span>
<span class="co">## [1] "2022-03-15 16:06:37 CET"</span>
<span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span>
<span class="co">## </span>
<span class="co">## Number of nodes: 1965</span>
<span class="co">## Number of edges: 58910</span>
<span class="co">## </span>
<span class="co">## Running Louvain algorithm...</span>
<span class="co">## Maximum modularity in 10 random starts: 0.8588</span>
<span class="co">## Number of communities: 14</span>
<span class="co">## Elapsed time: 0 seconds</span></code></pre>
<pre><code><span class="co">## Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric</span>
<span class="co">## To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'</span>
<span class="co">## This message will be shown once per session</span></code></pre>
<pre><code><span class="co">## [1] "2022-03-15 16:07:04 CET"</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#And plot a umap to check the output </span>
<span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">integrated_VGM</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, group.by <span class="op">=</span> <span class="st">"group_id"</span><span class="op">)</span>
<span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">integrated_VGM</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, group.by <span class="op">=</span> <span class="st">"VDJ_available"</span><span class="op">)</span></code></pre></div>
<p><img src="platypus_database_files/figure-html/unnamed-chunk-7-1.png" width="672"><img src="platypus_database_files/figure-html/unnamed-chunk-7-2.png" width="672">
## 3.2 Download processed VDJ_GEX_matrix</p>
<p>For each dataset, we generate a VDJ_GEX_matrix under default
settings. This is to give quick access to a dataset which is ready for
analysis, but comes at the cost of processing flexibility.</p>
<p>If the sample level Platypus.link element is empty (as below), the
data element can be either “VDJmatrix”, “GEXmatrix” or “ALL”. In case of
ALL both VDJ and GEX matrices are loaded and returned as one object.</p>
<p>Indipendently of what matrix is loaded, the classical list output
format of the VDJ_GEX_matrix is conserved.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/PlatypusDB_fetch.html">PlatypusDB_fetch</a></span><span class="op">(</span>
                PlatypusDB.links <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yermanos2021b//ALL"</span><span class="op">)</span>,
                save.to.disk <span class="op">=</span> <span class="cn">F</span>, 
                load.to.enviroment <span class="op">=</span> <span class="cn">T</span>, 
                load.to.list <span class="op">=</span> <span class="cn">F</span>, 
                combine.objects <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#Setting combine objects to true to return a single VGM</span></code></pre></div>
<pre><code><span class="co">## [1] "yermanos2021b__VDJGEXmatrix"</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Pass VGM onto Platypus analysis functions</span>
<span class="fu"><a href="../reference/VDJ_clonal_expansion.html">VDJ_clonal_expansion</a></span><span class="op">(</span><span class="va">yermanos2021b__VDJGEXmatrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, color.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="platypus_database_files/figure-html/unnamed-chunk-8-1.png" width="672">
## 4. Integrating local and PlatypusDB data</p>
<p>Comparing local data to established datasets is one of the core
functionalities of PlatypusDB.</p>
<p>The intregration is based on a standard by-sample data format and the
VDJ_GEX_matrix function.</p>
<p>Here we first load in a local dataset via the
PlatypusDB_load_from_disk() function (For showcasing purposes we load in
2 samples from the yermanos2021a dataset)</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#load in local data</span>
<span class="va">local_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlatypusDB_load_from_disk.html">PlatypusDB_load_from_disk</a></span><span class="op">(</span>
              VDJ.out.directory.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"C:/Users/PlatypusDB/yermanos2021b__VDJ_RAW/Aged.CNS.pool.3m.Bcell.S1"</span>,                     <span class="st">"C:/Users/PlatypusDB/yermanos2021b__VDJ_RAW/Aged.CNS.pool.12m.Bcell.S2"</span><span class="op">)</span>,
              GEX.out.directory.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"C:/Users/PlatypusDB/yermanos2021b__GEX_RAW/Aged.CNS.pool.3m.Bcell.S1"</span>,                     <span class="st">"C:/Users/PlatypusDB/yermanos2021b__GEX_RAW/Aged.CNS.pool.12m.Bcell.S2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Setting GEX directory to provided path/filtered_feature_bc_matrix</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co">#To process data with Feature barcode technology refer to the Platypus Feature Barcode vignette</span></code></pre></div>
<p>We next load samples 3 and 4 of the same dataset from PlatypusDB</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PlatypusDB_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlatypusDB_fetch.html">PlatypusDB_fetch</a></span><span class="op">(</span>
                PlatypusDB.links <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yermanos2021b/Aged.CNS.pool.18m.Bcell.S3/ALL"</span>,
                                     <span class="st">"yermanos2021b/Aged.CNS.single.18m.Bcell.S4/ALL"</span><span class="op">)</span>,
                save.to.disk <span class="op">=</span> <span class="cn">F</span>, 
                load.to.enviroment <span class="op">=</span> <span class="cn">F</span>, 
                load.to.list <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 2022-03-15 16:07:32: Starting download of yermanos2021b_Aged.CNS.pool.18m.Bcell.S3_VDJ.RData...</span></code></pre>
<pre><code><span class="co">## 2022-03-15 16:07:32: Starting download of yermanos2021b_Aged.CNS.pool.18m.Bcell.S3_GEX.RData...</span></code></pre>
<pre><code><span class="co">## 2022-03-15 16:07:32: Starting download of yermanos2021b_Aged.CNS.single.18m.Bcell.S4_VDJ.RData...</span></code></pre>
<pre><code><span class="co">## 2022-03-15 16:07:32: Starting download of yermanos2021b_Aged.CNS.single.18m.Bcell.S4_GEX.RData...</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Again this format contains per sample data in a nested list format. </span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PlatypusDB_data</span><span class="op">)</span> <span class="co">#List level 1: Samples</span></code></pre></div>
<pre><code><span class="co">## [1] "yermanos2021b_Aged.CNS.pool.18m.Bcell.S3_VDJGEXdata"  </span>
<span class="co">## [2] "yermanos2021b_Aged.CNS.single.18m.Bcell.S4_VDJGEXdata"</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PlatypusDB_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#List level 2: VDJ GEX FB data</span></code></pre></div>
<pre><code><span class="co">## [1] "VDJ"      "GEX"      "FB"       "VDJ path" "GEX_path" "Batch"</span></code></pre>
<p>Given the same format of loaded local data and downloaded data, the
VDJ_GEX_matrix function can now be used to integrate both</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vgm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VDJ_GEX_matrix.html">VDJ_GEX_matrix</a></span><span class="op">(</span>Data.in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">local_data</span> , <span class="va">PlatypusDB_data</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "2022-03-15 16:07:33 CET"</span></code></pre>
<pre><code><span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span>

<span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span>

<span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span>

<span class="co">## Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">## ('-')</span></code></pre>
<pre><code><span class="co">## [1] "2022-03-15 16:07:33 CET"</span>
<span class="co">## [1] "2022-03-15 16:07:33 CET"</span>
<span class="co">## [1] "2022-03-15 16:07:34 CET"</span>
<span class="co">## [1] "2022-03-15 16:07:34 CET"</span>
<span class="co">## [1] "2022-03-15 16:07:34 CET"</span>
<span class="co">## [1] "2022-03-15 16:07:35 CET"</span>
<span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span>
<span class="co">## </span>
<span class="co">## Number of nodes: 2064</span>
<span class="co">## Number of edges: 62935</span>
<span class="co">## </span>
<span class="co">## Running Louvain algorithm...</span>
<span class="co">## Maximum modularity in 10 random starts: 0.8945</span>
<span class="co">## Number of communities: 12</span>
<span class="co">## Elapsed time: 0 seconds</span>
<span class="co">## [1] "2022-03-15 16:07:56 CET"</span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Pass VGM onto Platypus analysis functions</span>
<span class="fu"><a href="../reference/VDJ_clonal_expansion.html">VDJ_clonal_expansion</a></span><span class="op">(</span><span class="va">vgm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, color.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="platypus_database_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="searching-for-public-cdr3s">5. Searching for public CDR3s<a class="anchor" aria-label="anchor" href="#searching-for-public-cdr3s"></a>
</h2>
<p>In case that shared CDR3s sequences and clones are of interest,
PlatypusDB allows searching for such without downloading all VDJ files
within the database. If both VDJ and VJ CDR3s are provided, the function
will also look for cells containing both sequences</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">public_clones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlatypusDB_find_CDR3s.html">PlatypusDB_find_CDR3s</a></span><span class="op">(</span>VDJ.cdr3s.aa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMRYGNYWYFDVW"</span><span class="op">)</span> , VJ.cdr3s.aa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CLQHGESPFTF"</span><span class="op">)</span>, projects.to.search <span class="op">=</span> <span class="st">"ALL"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">public_clones</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#subset of VDJ dataframes with query VDJ CDR3s</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">public_clones</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#subset of VDJ dataframes with query VJ CDR3s</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">public_clones</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#subset of VDJ dataframes with query VDJ AND VJ CDR3s</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">public_clones</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#Nr of cells in database containing query VDJ and VJ CDR3s</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="version-information">6. Version information<a class="anchor" aria-label="anchor" href="#version-information"></a>
</h2>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## R version 4.0.5 (2021-03-31)</span>
<span class="co">## Platform: x86_64-w64-mingw32/x64 (64-bit)</span>
<span class="co">## Running under: Windows 10 x64 (build 19044)</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   </span>
<span class="co">## [3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   </span>
<span class="co">## [5] LC_TIME=German_Germany.1252    </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] Platypus_3.3.3     SeuratObject_4.0.4 Seurat_4.1.0       forcats_0.5.1     </span>
<span class="co">##  [5] stringr_1.4.0      purrr_0.3.4        readr_2.1.2        tidyr_1.1.3       </span>
<span class="co">##  [9] tibble_3.1.2       ggplot2_3.3.5      tidyverse_1.3.1    dplyr_1.0.7       </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##   [1] readxl_1.3.1          backports_1.4.1       systemfonts_1.0.4    </span>
<span class="co">##   [4] plyr_1.8.6            igraph_1.2.6          lazyeval_0.2.2       </span>
<span class="co">##   [7] splines_4.0.5         listenv_0.8.0         scattermore_0.7      </span>
<span class="co">##  [10] digest_0.6.27         htmltools_0.5.2       fansi_0.5.0          </span>
<span class="co">##  [13] magrittr_2.0.1        memoise_2.0.1         tensor_1.5           </span>
<span class="co">##  [16] cluster_2.1.2         ROCR_1.0-11           tzdb_0.2.0           </span>
<span class="co">##  [19] globals_0.14.0        modelr_0.1.8          matrixStats_0.59.0   </span>
<span class="co">##  [22] pkgdown_2.0.2         spatstat.sparse_2.0-0 colorspace_2.0-2     </span>
<span class="co">##  [25] rvest_1.0.2           ggrepel_0.9.1         textshaping_0.3.6    </span>
<span class="co">##  [28] haven_2.4.3           xfun_0.27             crayon_1.5.0         </span>
<span class="co">##  [31] jsonlite_1.7.2        spatstat.data_2.1-2   survival_3.2-11      </span>
<span class="co">##  [34] zoo_1.8-9             glue_1.4.2            polyclip_1.10-0      </span>
<span class="co">##  [37] gtable_0.3.0          seqinr_4.2-8          leiden_0.3.9         </span>
<span class="co">##  [40] future.apply_1.8.1    BiocGenerics_0.36.1   abind_1.4-5          </span>
<span class="co">##  [43] scales_1.1.1          DBI_1.1.2             miniUI_0.1.1.1       </span>
<span class="co">##  [46] Rcpp_1.0.7            viridisLite_0.4.0     xtable_1.8-4         </span>
<span class="co">##  [49] reticulate_1.20       spatstat.core_2.2-0   htmlwidgets_1.5.4    </span>
<span class="co">##  [52] httr_1.4.2            RColorBrewer_1.1-2    ellipsis_0.3.2       </span>
<span class="co">##  [55] ica_1.0-2             farver_2.1.0          pkgconfig_2.0.3      </span>
<span class="co">##  [58] uwot_0.1.10           sass_0.4.0            dbplyr_2.1.1         </span>
<span class="co">##  [61] deldir_0.2-10         utf8_1.2.1            labeling_0.4.2       </span>
<span class="co">##  [64] tidyselect_1.1.1      rlang_0.4.10          reshape2_1.4.4       </span>
<span class="co">##  [67] later_1.2.0           munsell_0.5.0         cellranger_1.1.0     </span>
<span class="co">##  [70] tools_4.0.5           cachem_1.0.6          cli_3.1.1            </span>
<span class="co">##  [73] generics_0.1.2        ade4_1.7-18           broom_0.7.12         </span>
<span class="co">##  [76] ggridges_0.5.3        evaluate_0.14         fastmap_1.1.0        </span>
<span class="co">##  [79] yaml_2.2.1            ragg_1.2.1            goftest_1.2-2        </span>
<span class="co">##  [82] knitr_1.37            fs_1.5.2              fitdistrplus_1.1-6   </span>
<span class="co">##  [85] RANN_2.6.1            pbapply_1.5-0         future_1.23.0        </span>
<span class="co">##  [88] nlme_3.1-152          mime_0.11             xml2_1.3.3           </span>
<span class="co">##  [91] compiler_4.0.5        rstudioapi_0.13       plotly_4.10.0        </span>
<span class="co">##  [94] png_0.1-7             spatstat.utils_2.2-0  reprex_2.0.1         </span>
<span class="co">##  [97] bslib_0.3.1           stringi_1.7.4         highr_0.9            </span>
<span class="co">## [100] RSpectra_0.16-0       desc_1.4.0            lattice_0.20-44      </span>
<span class="co">## [103] Matrix_1.3-4          vctrs_0.3.8           pillar_1.7.0         </span>
<span class="co">## [106] lifecycle_1.0.1       spatstat.geom_2.2-0   lmtest_0.9-38        </span>
<span class="co">## [109] jquerylib_0.1.4       RcppAnnoy_0.0.18      data.table_1.14.0    </span>
<span class="co">## [112] cowplot_1.1.1         irlba_2.3.3           httpuv_1.6.1         </span>
<span class="co">## [115] patchwork_1.1.1       R6_2.5.1              promises_1.2.0.1     </span>
<span class="co">## [118] KernSmooth_2.23-20    gridExtra_2.3         parallelly_1.30.0    </span>
<span class="co">## [121] codetools_0.2-18      MASS_7.3-54           assertthat_0.2.1     </span>
<span class="co">## [124] rprojroot_2.0.2       withr_2.4.3           sctransform_0.3.3    </span>
<span class="co">## [127] mgcv_1.8-36           parallel_4.0.5        hms_1.1.1            </span>
<span class="co">## [130] grid_4.0.5            rpart_4.1-15          rmarkdown_2.11       </span>
<span class="co">## [133] Rtsne_0.15            shiny_1.7.1           lubridate_1.8.0</span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Yermanos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
