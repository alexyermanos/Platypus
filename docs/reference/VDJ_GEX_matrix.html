<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Processes both raw VDJ and GEX Cellranger output to compile a single cell level table containing all available information for each cell. If using Feature Barcodes please note the [FB] paragraph in the description and all "FB." parameters — VDJ_GEX_matrix • Platypus</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Processes both raw VDJ and GEX Cellranger output to compile a single cell level table containing all available information for each cell. If using Feature Barcodes please note the [FB] paragraph in the description and all "FB." parameters — VDJ_GEX_matrix" />
<meta property="og:description" content="# This function is designed as a common input to the Platypus pipeline. Integration of datasets as well as VDJ and GEX information is done here. Please check the Platypus V3 vignette for a detailed walkthrough of the output structure. In short: output[[1]] = VDJ table, output[[2]] = GEX Seurat object and output[[3]] = statistics
# [FB] Feature barcode (FB) technology is getting increasingly popular, which is why Platypus V3 fully supports their use as sample delimiters. As of V3, Platpyus does not support Cite-seq data natively, also the VDJ_GEX_matrix function is technically capable of loading a Cite-seq matrix and integrating it with VDJ. For details on how to process sequencing data with FB data and how to supply this information to the VDJ_GEX_matrix function, please consult the dedicated vignette on FB data." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/PlatypusV3_agedCNS.html">Platypus V3</a>
    </li>
    <li>
      <a href="../articles/PlatypusDB.html">PlatypusDB</a>
    </li>
    <li>
      <a href="../articles/Platypus_feature_barcodes.html">Platypus V3 Feature barcodes</a>
    </li>
    <li>
      <a href="../articles/ABForests.html">ABForests</a>
    </li>
    <li>
      <a href="../articles/Echidna.html">Echidna</a>
    </li>
  </ul>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://immunesim.readthedocs.io/en/latest/">ImmuneSIM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/alexyermanos">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Processes both raw VDJ and GEX Cellranger output to compile a single cell level table containing all available information for each cell. If using Feature Barcodes please note the [FB] paragraph in the description and all "FB." parameters</h1>
    <small class="dont-index">Source: <a href='https://github.com/alexyermanos/Platypus/tree/masterR/VDJ_GEX_matrix.R'><code>R/VDJ_GEX_matrix.R</code></a></small>
    <div class="hidden name"><code>VDJ_GEX_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p># This function is designed as a common input to the Platypus pipeline. Integration of datasets as well as VDJ and GEX information is done here. Please check the Platypus V3 vignette for a detailed walkthrough of the output structure. In short: output[[1]] = VDJ table, output[[2]] = GEX Seurat object and output[[3]] = statistics
# [FB] Feature barcode (FB) technology is getting increasingly popular, which is why Platypus V3 fully supports their use as sample delimiters. As of V3, Platpyus does not support Cite-seq data natively, also the VDJ_GEX_matrix function is technically capable of loading a Cite-seq matrix and integrating it with VDJ. For details on how to process sequencing data with FB data and how to supply this information to the VDJ_GEX_matrix function, please consult the dedicated vignette on FB data.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>VDJ_GEX_matrix</span><span class='op'>(</span>
  <span class='va'>VDJ.out.directory.list</span>,
  <span class='va'>GEX.out.directory.list</span>,
  <span class='va'>FB.out.directory.list</span>,
  <span class='va'>Data.in</span>,
  <span class='va'>Seurat.in</span>,
  <span class='va'>VDJ.combine</span>,
  <span class='va'>GEX.integrate</span>,
  <span class='va'>integrate.GEX.to.VDJ</span>,
  <span class='va'>integrate.VDJ.to.GEX</span>,
  <span class='va'>exclude.GEX.not.in.VDJ</span>,
  <span class='va'>filter.overlapping.barcodes.GEX</span>,
  <span class='va'>filter.overlapping.barcodes.VDJ</span>,
  <span class='va'>exclude.on.cell.state.markers</span>,
  <span class='va'>get.VDJ.stats</span>,
  <span class='va'>numcores</span>,
  <span class='va'>trim.and.align</span>,
  <span class='va'>select.excess.chains.by.umi.count</span>,
  <span class='va'>gap.opening.cost</span>,
  <span class='va'>gap.extension.cost</span>,
  <span class='va'>parallel.processing</span>,
  <span class='va'>integration.method</span>,
  <span class='va'>VDJ.gene.filter</span>,
  <span class='va'>mito.filter</span>,
  <span class='va'>norm.scale.factor</span>,
  <span class='va'>n.feature.rna</span>,
  <span class='va'>n.count.rna.min</span>,
  <span class='va'>n.count.rna.max</span>,
  <span class='va'>n.variable.features</span>,
  <span class='va'>cluster.resolution</span>,
  <span class='va'>neighbor.dim</span>,
  <span class='va'>mds.dim</span>,
  <span class='va'>subsample.barcodes</span>,
  <span class='va'>FB.count.threshold</span>,
  <span class='va'>FB.ratio.threshold</span>,
  <span class='va'>group.id</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>VDJ.out.directory.list</th>
      <td><p>List containing paths to VDJ output directories from cell ranger. This pipeline assumes that the output file names have not been changed from the default 10x settings in the /outs/ folder. This is compatible with B and T cell repertoires. ! Neccessary files within this folder: filtered_contig_annotations.csv, clonotypes.csv, concat_ref.fasta, all_contig_annotations.csv (only if trim.and.align == T) and metrics_summary.csv (Optional, will be appended to stats table if get.VDJ.stats == T)</p></td>
    </tr>
    <tr>
      <th>GEX.out.directory.list</th>
      <td><p>List containing paths the outs/ directory of each sample or directly the raw or filtered_feature_bc_matrix folder. Order of list items must be the same as for VDJ.</p></td>
    </tr>
    <tr>
      <th>FB.out.directory.list</th>
      <td><p>[FB] List of paths pointing at the outs/ directory of output from the Cellranger counts function which contain Feature barcode counts. ! Single list elements can be a path or "PLACEHOLDER", if the corresponding input in the VDJ or GEX path does not have any adjunct FB data. This is only the case when integrating two datasets of which only one has FB data. See examples for details. Any input will overwrite potential FB data loaded from the GEX input directories. This may be important, if wanting to input unfiltered FB data that will cover also cells in VDJ not present in GEX.</p></td>
    </tr>
    <tr>
      <th>Data.in</th>
      <td><p>Input for R objects from either the PlatypusDB_load_from_disk or the PlatypusDB_fetch function. If provided, input directories should not be specified. If you wish to integrate local and downloaded data, please load them via load_from_disk and fetch and provide as a list (e.g. Data.in = list(load_from_disk.output, fetch.output))</p></td>
    </tr>
    <tr>
      <th>Seurat.in</th>
      <td><p>Alternative to GEX.out.directory.list. List of processed (!) seurat objects. Length of the list can either be 1 if VDJ.integrate = TRUE or equal to the length of VDJ.out.directory.list if VDJ.integrate = FALSE. In metadata the column sample_id and group_id must be present. sample_id must contain ids in the format "s1", "s2" ... "sn" and must be matching the order of VDJ.out.directory.list. No processing (i.e. data normalisation and integration) will be performed on these objects. They will be returned as part of the VGM and with additional VDJ data if integrate.VDJ.to.GEX = T. Filtering parameters such as overlapping barcodes, exclude.GEX.not.in.VDJ and exclude.on.cell.state.markers will be applied to the Seurat.in GEX object(s).</p></td>
    </tr>
    <tr>
      <th>VDJ.combine</th>
      <td><p>Boolean. Defaults to TRUE. Whether to integrate repertoires. A sample identifier will be appended to each barcode both in GEX as well as in VDJ. Recommended for all later functions</p></td>
    </tr>
    <tr>
      <th>GEX.integrate</th>
      <td><p>Boolean. Defaults to TRUE. Whether to integrate GEX data. Default settings use the seurat scale.data option to integrate datasets. Sample identifiers will be appended to each barcode both in GEX and VDJ This is helpful when analysing different samples from the same organ or tissue, while it may be problematic when analysing different tissues.</p></td>
    </tr>
    <tr>
      <th>integrate.GEX.to.VDJ</th>
      <td><p>Boolean. defaults to TRUE. Whether to integrate GEX metadata (not raw counts) into the VDJ output dataframe ! Only possible, if GEX.integrate and VDJ.combine are either both FALSE or both TRUE</p></td>
    </tr>
    <tr>
      <th>integrate.VDJ.to.GEX</th>
      <td><p>Boolean. defaults to TRUE. Whether to integrate VDJ data into GEX seurat object as metadata. ! Only possible, if GEX.integrate and VDJ.combine are either both FALSE or both TRUE</p></td>
    </tr>
    <tr>
      <th>exclude.GEX.not.in.VDJ</th>
      <td><p>Boolean. defaults to FALSE. Whether to delete all GEX cell entries, for which no VDJ information is available. Dependent on data quality and sequencing depth this may reduce the GEX cell count by a significant number</p></td>
    </tr>
    <tr>
      <th>filter.overlapping.barcodes.GEX</th>
      <td><p>Boolean. defaults to TRUE. Whether to remove barcodes which are shared among samples in the GEX analysis. Shared barcodes normally appear at a very low rate.</p></td>
    </tr>
    <tr>
      <th>filter.overlapping.barcodes.VDJ</th>
      <td><p>Boolean. defaults to TRUE. Whether to remove barcodes which are shared among samples in the GEX analysis. Shared barcodes normally appear at a very low rate.</p></td>
    </tr>
    <tr>
      <th>exclude.on.cell.state.markers</th>
      <td><p>Character vector. If no input is provided or input is "none", no cells are excluded. Input format should follow: Character vector containing the gene names for each state. ; is used to use multiple markers within a single gene state. Different vector elements correspond to different states. Example: c("CD4+;CD44-","CD4+;IL7R+;CD44+"). All cells which match any of the given states (in the example case any of the 2) are excluded. This is useful in case different and non lymphocyte cells were co-sequenced. It should give the option to e.g. exclude B cells in the analysis of T cells in a dataset.</p></td>
    </tr>
    <tr>
      <th>get.VDJ.stats</th>
      <td><p>Boolean. defaults to TRUE. Whether to generate general statistics table for VDJ repertoires. This is appended as element [[3]] of the output list.</p></td>
    </tr>
    <tr>
      <th>numcores</th>
      <td><p>Number of cores used for parallel processing. Defaults to number of cores available. If you want to chek how many cores are available use the library Parallel and its command detectCores() (Not setting a limit here when running this function on a cluster may cause a crash)</p></td>
    </tr>
    <tr>
      <th>trim.and.align</th>
      <td><p>Boolean. Defaults to FALSE. Whether to trim VJ/VDJ seqs, align them to the 10x reference and trim the reference. This is useful to get full sequences for antibody expression or numbers of somatic hypermutations. !Setting this to TRUE significantly increases computational time</p></td>
    </tr>
    <tr>
      <th>select.excess.chains.by.umi.count</th>
      <td><p>Boolean. Defaults to FALSE. There are several methods of dealing with cells containing reads for more than 1VDJ and 1VJ chain. While many analyses just exclude such cells, the VGM is designed to keep these for downstream evaluation (e.g. in VDJ_clonotype). This option presents an evidenced-based way of selectively keeping only one of the present VDJ  and VJ chains each. E.g. if set to TRUE from all present VDJ chains in a cell only the one with the highest UMI count is kept. (in case of same UMI counts, the chain first in the contig files is kept). Idea source: Zhang W et al. Sci Adv. 2021 (10.1126/sciadv.abf5835)</p></td>
    </tr>
    <tr>
      <th>gap.opening.cost</th>
      <td><p>Argument passed to Biostrings::pairwiseAlignment during alignment to reference. Defaults to 10</p></td>
    </tr>
    <tr>
      <th>gap.extension.cost</th>
      <td><p>Argument passed to Biostrings::pairwiseAlignment during alignment to reference. Defaults to 4</p></td>
    </tr>
    <tr>
      <th>parallel.processing</th>
      <td><p>Character string. Can be "parlapply" for Windows system, "mclapply" for unix and Mac systems or "none" to use a simple for loop (slow!). Default is "none" for compatibility reasons. For the parlapply option the packages parallel, doParallel and the dependency foreach are required</p></td>
    </tr>
    <tr>
      <th>integration.method</th>
      <td><p>String specifying which data normalization and integration pipeline should be used. Default is "scale.data", which correspondings to the ScaleData function internal to harmony package. 'anchors' scales data individually and then finds and align cells in similar states as described here: https://satijalab.org/seurat/articles/integration_introduction.html. 'sct'specifies SCTransform from the Seurat package. "harmony" should be specificied to perform harmony integration. This method requires the harmony package from bioconductor.</p></td>
    </tr>
    <tr>
      <th>VDJ.gene.filter</th>
      <td><p>Logical indicating if variable genes from the b cell receprot and t cell receptor should be removed from the analysis. True is highly recommended to avoid clonal families clustering together.</p></td>
    </tr>
    <tr>
      <th>mito.filter</th>
      <td><p>Numeric specifying which percent of genes are allowed to be composed of mitochondrial genes. This value may require visual inspection and can be specific to each sequencing experiment. Users can visualize the percentage of genes corresponding to mitochondrial genes using the function "investigate_mitochondial_genes".</p></td>
    </tr>
    <tr>
      <th>norm.scale.factor</th>
      <td><p>Scaling factor for the standard Seurat pipeline. Default is set to 10000 as reported in Seurat documentation.</p></td>
    </tr>
    <tr>
      <th>n.feature.rna</th>
      <td><p>Numeric that specifies which cells should be filtered out due to low number of detected genes. Default is set to 0. Seurat standard pipeline uses 2000.</p></td>
    </tr>
    <tr>
      <th>n.count.rna.min</th>
      <td><p>Numeric that specifies which cells should be filtered out due to low RNA count.Default is set to 0. Seurat standard pipeline without VDJ information uses 200.</p></td>
    </tr>
    <tr>
      <th>n.count.rna.max</th>
      <td><p>Numeric that specifies which cells should be filtered out due to high RNA count.Default is set to infinity. Seurat standard pipeline without VDJ information uses 2500.</p></td>
    </tr>
    <tr>
      <th>n.variable.features</th>
      <td><p>Numeric specifying the number of variable features. Default set to 2000 as specified in Seurat standard pipeline.</p></td>
    </tr>
    <tr>
      <th>cluster.resolution</th>
      <td><p>Numeric specifying the resolution that will be supplied to Seurat's FindClusters function. Default is set to 0.5. Increasing this number will increase the number of distinct Seurat clusters. Suggested to examine multiple parameters to ensure gene signatures differentiating clusters remains constant.</p></td>
    </tr>
    <tr>
      <th>neighbor.dim</th>
      <td><p>Numeric vector specifying which dimensions should be supplied in the FindNeighbors function from Seurat. Default input is '1:10'.</p></td>
    </tr>
    <tr>
      <th>mds.dim</th>
      <td><p>Numeric vector specifying which dimensions should be supplied into dimensional reduction techniques in Seurat and Harmony. Default input is '1:10'.</p></td>
    </tr>
    <tr>
      <th>subsample.barcodes</th>
      <td><p>For development purposes only. If set to TRUE the function will run on 100 cells only to increase speeds of debugging</p></td>
    </tr>
    <tr>
      <th>FB.count.threshold</th>
      <td><p>Numeric. Defaults to 10. For description of Feature Barcode assignment see parameter FB.ratio.threshold above</p></td>
    </tr>
    <tr>
      <th>FB.ratio.threshold</th>
      <td><p>Numeric. Defaults to 2 Threshold for assignment of feature barcodes by counts. A feature barcode is assigned to a cell if its counts are &gt;FB.count.threshold and if its counts are FB.ratio.threshold-times higher than the counts of the feature barcode with second most counts.</p></td>
    </tr>
    <tr>
      <th>group.id</th>
      <td><p>vector with integers specifying the group membership. c(1,1,2,2) would specify the first two elements of the input VDJ/GEX lists are in group 1 and the third/fourth input elements will be in group 2.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Single cell matrix including VDJ and GEX info</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"~/VDJ/S1/"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"~/VDJ/S2/"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"~/GEX/S1/"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"~/GEX/S2/"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VGM</span> <span class='op'>&lt;-</span> <span class='fu'>VDJ_GEX_matrix</span><span class='op'>(</span></span>
<span class='r-in'>VDJ.out.directory.list <span class='op'>=</span> <span class='va'>VDJ.out.directory.list</span></span>
<span class='r-in'>,GEX.out.directory.list <span class='op'>=</span> <span class='va'>GEX.out.directory.list</span></span>
<span class='r-in'>,GEX.integrate <span class='op'>=</span> <span class='cn'>T</span></span>
<span class='r-in'>,VDJ.combine <span class='op'>=</span> <span class='cn'>T</span></span>
<span class='r-in'>,integrate.GEX.to.VDJ <span class='op'>=</span> <span class='cn'>T</span></span>
<span class='r-in'>,integrate.VDJ.to.GEX <span class='op'>=</span> <span class='cn'>T</span></span>
<span class='r-in'>,exclude.GEX.not.in.VDJ <span class='op'>=</span> <span class='cn'>F</span></span>
<span class='r-in'>,filter.overlapping.barcodes.GEX <span class='op'>=</span> <span class='cn'>F</span></span>
<span class='r-in'>,filter.overlapping.barcodes.VDJ <span class='op'>=</span> <span class='cn'>F</span></span>
<span class='r-in'>,get.VDJ.stats <span class='op'>=</span> <span class='cn'>T</span></span>
<span class='r-in'>,parallel.processing <span class='op'>=</span> <span class='st'>"none"</span></span>
<span class='r-in'>,subsample.barcodes <span class='op'>=</span> <span class='cn'>F</span></span>
<span class='r-in'>,trim.and.align <span class='op'>=</span> <span class='cn'>F</span></span>
<span class='r-in'>,group.id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># With Feature Barcodes</span></span>
<span class='r-in'><span class='co'>## Option 1: Cellranger multi or Cellranger count with --libraries output</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/VDJ/S1/"</span> <span class='co'>#point to outs or per_sample_outs directory content</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/VDJ/S2/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/GEX/S1/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/GEX/S2/"</span> <span class='co'>#These directories contain two matrices (GEX and FB)</span></span>
<span class='r-in'><span class='va'>VGM</span> <span class='op'>&lt;-</span> <span class='fu'>VDJ_GEX_matrix</span><span class='op'>(</span></span>
<span class='r-in'>VDJ.out.directory.list <span class='op'>=</span> <span class='va'>VDJ.out.directory.list</span></span>
<span class='r-in'>,GEX.out.directory.list <span class='op'>=</span> <span class='va'>GEX.out.directory.list</span>,</span>
<span class='r-in'>FB.ratio.threshold <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Option 2: Separate input of FB data from separate Cellranger count run</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/VDJ/S1/"</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/VDJ/S2/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/GEX/S1/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/GEX/S2/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>FB.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~FB/S1/"</span></span>
<span class='r-in'><span class='va'>FB.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~FB/S1/"</span></span>
<span class='r-in'><span class='va'>VGM</span> <span class='op'>&lt;-</span> <span class='fu'>VDJ_GEX_matrix</span><span class='op'>(</span></span>
<span class='r-in'>VDJ.out.directory.list <span class='op'>=</span> <span class='va'>VDJ.out.directory.list</span>,</span>
<span class='r-in'>GEX.out.directory.list <span class='op'>=</span> <span class='va'>GEX.out.directory.list</span>,</span>
<span class='r-in'>FB.out.directory.list <span class='op'>=</span> <span class='va'>FB.out.directory.list</span>,</span>
<span class='r-in'>FB.ratio.threshold <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Option 3: FB input for two datasets of which only one contains FB data</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study1/VDJ/S1/"</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/VDJ/S1/"</span></span>
<span class='r-in'><span class='va'>VDJ.out.directory.list</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/VDJ/S2/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study1/GEX/S1/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/GEX/S1/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/GEX/S2/"</span></span>
<span class='r-in'><span class='va'>GEX.out.directory.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>FB.out.directory.list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"PLACEHOLDER"</span> <span class='co'>#Study 1 does not contain FB data</span></span>
<span class='r-in'><span class='va'>FB.out.directory.list</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/FB/S1/"</span></span>
<span class='r-in'><span class='va'>FB.out.directory.list</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"~/study2/FB/S2/"</span></span>
<span class='r-in'><span class='va'>VGM</span> <span class='op'>&lt;-</span> <span class='fu'>VDJ_GEX_matrix</span><span class='op'>(</span></span>
<span class='r-in'>VDJ.out.directory.list <span class='op'>=</span> <span class='va'>VDJ.out.directory.list</span>,</span>
<span class='r-in'>GEX.out.directory.list <span class='op'>=</span> <span class='va'>GEX.out.directory.list</span>,</span>
<span class='r-in'>FB.out.directory.list <span class='op'>=</span> <span class='va'>FB.out.directory.list</span>,</span>
<span class='r-in'>FB.ratio.threshold <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='op'>}</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Alexander Yermanos.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


