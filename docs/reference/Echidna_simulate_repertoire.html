<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate immune repertoire and transcriptome data — Echidna_simulate_repertoire • Platypus</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate immune repertoire and transcriptome data — Echidna_simulate_repertoire" />
<meta property="og:description" content="Simulate repertoire and transcriptome matrix, with igraph tree plot for each clone showing the evolution process. the node in the tree plot are colored with transcriptome state and isotype." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette_index.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_index.html">View all</a>
    </li>
    <li class="dropdown-header">First steps</li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/platypus_database.html">Platypus Database</a>
    </li>
    <li>
      <a href="../articles/airr_compatibility.html">AIRR compatibility and TRUST4</a>
    </li>
    <li>
      <a href="../articles/vdj_gex_integration.html">VDJ-GEX integration</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">GEX analysis using Seurat</li>
    <li>
      <a href="../articles/quality_control.html">Quality control</a>
    </li>
    <li>
      <a href="../articles/feature_barcodes.html">Feature Barcodes</a>
    </li>
    <li>
      <a href="../articles/GEX_overview.html">GEX overview</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">VDJ analysis</li>
    <li>
      <a href="../articles/clonotyping.html">Clonotyping</a>
    </li>
    <li>
      <a href="../articles/clonal_expansion.html">Clonal expansion</a>
    </li>
    <li>
      <a href="../articles/germline_genes.html">Germline gene and isotype usage</a>
    </li>
    <li>
      <a href="../articles/sampling_diversity.html">Sampling and diversity analysis</a>
    </li>
    <li>
      <a href="../articles/somatic_hypermutations.html">Somatic hypermutations</a>
    </li>
    <li>
      <a href="../articles/TCR_look_up.html">TCR look up and specificity</a>
    </li>
    <li>
      <a href="../articles/mixcr_antibody_expression.html">MiXCR and Antibody expression</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data simulation</li>
    <li>
      <a href="../articles/echidna.html">Echidna</a>
    </li>
  </ul>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://immunesim.readthedocs.io/en/latest/">ImmuneSIM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/alexyermanos">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate immune repertoire and transcriptome data</h1>
    <small class="dont-index">Source: <a href='https://github.com/alexyermanos/Platypus/tree/masterR/Echidna_simulate_repertoire.R'><code>R/Echidna_simulate_repertoire.R</code></a></small>
    <div class="hidden name"><code>Echidna_simulate_repertoire.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate repertoire and transcriptome matrix, with igraph tree plot for each clone showing the evolution process. the node in the tree plot are colored with transcriptome state and isotype.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>Echidna_simulate_repertoire</span><span class='op'>(</span>
  <span class='va'>initial.size.of.repertoire</span>,
  <span class='va'>species</span>,
  <span class='va'>cell.type</span>,
  <span class='va'>cd4.proportion</span>,
  <span class='va'>duration.of.evolution</span>,
  <span class='va'>complete.duration</span>,
  <span class='va'>vdj.productive</span>,
  <span class='va'>vdj.model</span>,
  <span class='va'>vdj.insertion.mean</span>,
  <span class='va'>vdj.insertion.stdv</span>,
  <span class='va'>vdj.branch.prob</span>,
  <span class='va'>clonal.selection</span>,
  <span class='va'>cell.division.prob</span>,
  <span class='va'>sequence.selection.prob</span>,
  <span class='va'>special.v.gene</span>,
  <span class='va'>class.switch.prob</span>,
  <span class='va'>class.switch.selection.dependent</span>,
  <span class='va'>class.switch.independent</span>,
  <span class='va'>SHM.method</span>,
  <span class='va'>SHM.nuc.prob</span>,
  <span class='va'>SHM.isotype.dependent</span>,
  <span class='va'>SHM.phenotype.dependent</span>,
  <span class='va'>max.cell.number</span>,
  <span class='va'>max.clonotype.number</span>,
  <span class='va'>death.rate</span>,
  <span class='va'>igraph.on</span>,
  <span class='va'>transcriptome.on</span>,
  <span class='va'>transcriptome.switch.independent</span>,
  <span class='va'>transcriptome.switch.prob</span>,
  <span class='va'>transcriptome.switch.isotype.dependent</span>,
  <span class='va'>transcriptome.switch.SHM.dependent</span>,
  <span class='va'>transcriptome.switch.selection.dependent</span>,
  <span class='va'>transcriptome.states</span>,
  <span class='va'>transcriptome.noise</span>,
  <span class='va'>seq.name</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>initial.size.of.repertoire</th>
      <td><p>The initial number of existing cells when the evolution starts. Default is 10.</p></td>
    </tr>
    <tr>
      <th>species</th>
      <td><p>The species of the simulated repertoire, can be "mus" for mouse or "hum" for human. Default is "mus".</p></td>
    </tr>
    <tr>
      <th>cell.type</th>
      <td><p>The cell type for the simulation. "B" or "T"</p></td>
    </tr>
    <tr>
      <th>cd4.proportion</th>
      <td><p>A number between 0 and 1 specifying the proportion of Cd4+ T cells, when cell.type is "T" and transcirptime states data is default. Default is 1, all the cells are Cd4. When user specify transciptome data for T cells, mixture of CD4+ and CD8+ T cells are not applicable.</p></td>
    </tr>
    <tr>
      <th>duration.of.evolution</th>
      <td><p>The maxim time steps for simulation.</p></td>
    </tr>
    <tr>
      <th>complete.duration</th>
      <td><p>TRUE or FALSE. Default is TURE. If TURE, after cell number or clone number reaches the upper limit, the evolution(class switch, mutation, transcriptional state switch) will continue until the duration.of.evolution is complete. If FLASE, the evolution will stop when either cell number or clone number reaches the limit.</p></td>
    </tr>
    <tr>
      <th>vdj.productive</th>
      <td><p>"random": the sequence will be generated from random VDJ recombination, there might be a proportion of unproductive sequences.These VDJ genes were taken from IMGT. When more than one allele was present for a given gene, the first was used. "naive": the VDJ sequence be sampled from a pool of productive sequences obtained by filtering randomly simulated sequences with MIXCR. "vae": the VDJ sequence be sampled from a pool of productive sequences obtained by filtering sequences generated from vae models with MIXCR.</p></td>
    </tr>
    <tr>
      <th>vdj.model</th>
      <td><p>Specifies the model used to simulate V-D-J recombination. Can be either "naive" or "data". "naive" is chain independent and does not differentiate between different species. To rely on the default "experimental" options, this should be "data" and the parameter vdj.insertion.mean should be "default". This will allow for different mean additions for either the VD and JD junctions and will differ depending on species.</p></td>
    </tr>
    <tr>
      <th>vdj.insertion.mean</th>
      <td><p>Integer value describing the mean number of nucleotides to be inserted during simulated V-D-J recombination events. If "default" is entered, the mean will be normally distributed.</p></td>
    </tr>
    <tr>
      <th>vdj.insertion.stdv</th>
      <td><p>Integer value describing the standard deviation corresponding to insertions of V-D-J recombination. No "default" parameter currently supported but will be updated with future experimental data. This should be a number if using a custom distribution for V-D-J recombination events, but can be "default" if using the "naive" vdj.model or the "data", with vdj.insertion.mean set to "default".</p></td>
    </tr>
    <tr>
      <th>vdj.branch.prob</th>
      <td><p>Probability of new VDJ recombination event in each time step.when new VDJ recombination happen, a new cell with a new sequence will be generated. Default is 0.2.</p></td>
    </tr>
    <tr>
      <th>clonal.selection</th>
      <td><p>TRUE or FALSE. If TURE, cells in clones with higher frequency have their division probability proportional to the clonal frequency. If FALSE, clones with higher frequency will have lower probability to expand.</p></td>
    </tr>
    <tr>
      <th>cell.division.prob</th>
      <td><p>Probability of cells to be duplicated in each time step. Default is 0.1. If uneven probability for different clones is needed, the input should be a vector of 2 numeric items, with the first item being the lower bound, the second item being the upper bound of the division rate. The most abundant clone will get the highest division rate, and division rate of other clones will follow arithmetic progression and keep decreasing until the last abundant clone with the lower limit of division rate. If input 3 values, the third value will be the division rate for cells with selected sequences. If a fourth number is given, the division probability of selected sequence will be sampled between the third number and the fourth number.</p></td>
    </tr>
    <tr>
      <th>sequence.selection.prob</th>
      <td><p>Probability of each unique sequence to be selected as expanding sequence.Expanding sequences can have their division rate specified in the third element of cell.division.prob.</p></td>
    </tr>
    <tr>
      <th>special.v.gene</th>
      <td><p>If TRUE, simulation will apply special sequence.selection.prob for heavy and light chain v gene combination specified in dataframe "special_v".</p></td>
    </tr>
    <tr>
      <th>class.switch.prob</th>
      <td><p>Probability matrix of class switching for b cells. The row names of the matrix are the isotypes the cell is switching from, the column names are the isotypes the cell is switching to. All B cells start from IGHM, and switch to one of the other isotypes or remain the same. Default values are in the attaching matrix "class_switch_prob_hum" and "class_switch_prob_mus". The order of isotype in rows and columns should be the same.</p></td>
    </tr>
    <tr>
      <th>class.switch.selection.dependent</th>
      <td><p>If TRUE,class switching will happen when the cell is selected,if the cell has IgM or IgD isotype.</p></td>
    </tr>
    <tr>
      <th>class.switch.independent</th>
      <td><p>If TRUE, class switching will happen randomly at each time step for all cells. If FALSE, random class switching will be switched off.</p></td>
    </tr>
    <tr>
      <th>SHM.method</th>
      <td><p>The mode of SHM speciation events. Options are either: "poisson","data","motif","wrc", and "all". Specifying either "poisson" or "naive" will result in mutations that can occur anywhere in the heavy chain region, with each nucleotide having an equal probability for a mutation event. Specifying "data" focuses mutation events during SHM in the CDR regions (based on IMGT), and there will be an increased probability for transitions (and decreased probability for transversions). Specifying "motif" will cause neighbor dependent mutations based on a mutational matrix from high throughput sequencing data sets (Yaari et al., Frontiers in Immunology, 2013). "wrc" allows for only the WRC mutational hotspots to be included (where W equals A or T and R equals A or G). Specifying "all" will use all four types of mutations during SHM branching events, where the weights for each can be specified in the "SHM.nuc.prob" parameter.</p></td>
    </tr>
    <tr>
      <th>SHM.nuc.prob</th>
      <td><p>Specifies the rate at which nucleotides change during speciation (SHM) events. This parameter depends on the type of mutation specified by SHM.method. For both "poisson" and "data", the input value determines the probability for each site to mutate (the whole sequence for "poisson" and the CDRs for "data"). For either "motif" or "wrc", the number of mutations per speciation event should be specified. Note that these are not probabilities, but the number of mutations that can occur (if the mutation is present in the sequence). If "all" is specified, the input should be a vector where the first element controls the poisson style mutations, second controls the "data", third controls the "motif" and fourth controls the "wrc".</p></td>
    </tr>
    <tr>
      <th>SHM.isotype.dependent</th>
      <td><p>If TRUE, somatic hypermutation of certain isotype will happen based on probability specified in dataframe "iso_SHM_prob".</p></td>
    </tr>
    <tr>
      <th>SHM.phenotype.dependent</th>
      <td><p>If TRUE, somatic hypermutation of certain phenotype will happen based on probability specified in dataframe "pheno_SHM_prob".</p></td>
    </tr>
    <tr>
      <th>max.cell.number</th>
      <td><p>Integer value describing maximum number of cells allowed. Default is 1500.</p></td>
    </tr>
    <tr>
      <th>max.clonotype.number</th>
      <td><p>Integer value describing maximum number of clones allowed. cell derived from the same mother cell belong to same clone.</p></td>
    </tr>
    <tr>
      <th>death.rate</th>
      <td><p>Probability of cell death happen to each cell in each time step.</p></td>
    </tr>
    <tr>
      <th>igraph.on</th>
      <td><p>If TRUE, mutational network for every B cell clone will be in the output. If False, the igraphs will not be included.</p></td>
    </tr>
    <tr>
      <th>transcriptome.on</th>
      <td><p>If TRUE, the simulation will include transcriptome data. If FALSE, only vdj sequence will be simulated.</p></td>
    </tr>
    <tr>
      <th>transcriptome.switch.independent</th>
      <td><p>TRUE or FALSE value describing whether transcriptome state is allowed to switch independently, not dependent on class switching or somatic hypermutation. If TURE, transcriptome.switch.prob should be specified to control the probability of transcriptome state switching.</p></td>
    </tr>
    <tr>
      <th>transcriptome.switch.prob</th>
      <td><p>Probability of transcriptome state switching independently. Default values are in the attaching matrix "trans_switch_prob_b" and "trans_switch_prob_t". The order of cell type in rows and columns should be the same, and the order of the cell type in the matrix should match cell type names in transcriptome.states.</p></td>
    </tr>
    <tr>
      <th>transcriptome.switch.isotype.dependent</th>
      <td><p>TRUE or FALSE value describing whether transcriptome state of a cell is allowed to switch depending on isotype switching. If TRUE, transcriptome state will switch once class switching happens.</p></td>
    </tr>
    <tr>
      <th>transcriptome.switch.SHM.dependent</th>
      <td><p>TRUE or FALSE value describing whether transcriptome state of a cell is allowed to switch depending on somatic hypermutation. If TRUE, transcriptome state will switch once somatic hypermutation happens.</p></td>
    </tr>
    <tr>
      <th>transcriptome.switch.selection.dependent</th>
      <td><p>If TRUE, selected cells will undergo transcriptome state switching if their transcriptome state is 1.</p></td>
    </tr>
    <tr>
      <th>transcriptome.states</th>
      <td><p>A data.frame specifying base gene expression for different cell type, with gene names as row names, cell type names as column names. When missing, a default data.frame will be used. Default data.frame includes "GerminalcenterBcell", "NaiveBcell", "Plasmacell", "MemoryBcell" for B cells, and "Naïve Cd4", "ActivatedCd4", "MemoryCd4", "NaiveCd8", "EffectorCd8" ,"MemoryCd8","ExhaustedCd8" for T cells. The order of the cell type names in transcriptome.states should match cell type names in the transcriptome.switch.prob matrix.</p></td>
    </tr>
    <tr>
      <th>transcriptome.noise</th>
      <td><p>A character expression specifying the distribution of noise ratio to be multiplied with the base gene expression for each cell. It should be a text expression that generates a numeric vector, which is of the same length as gene names in the trasncriptome.state input. Default value is "rnorm(nrow(transcriptome.states), mean = 1, sd = 0.3)".</p></td>
    </tr>
    <tr>
      <th>seq.name</th>
      <td><p>Integer specifies how many top-ranking clones are included in Seq_Name dataframe in the output list for phylogenetic tree plotting in other pipeline. If missing, Seq_Name won't be included in the output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the VDJ sequence and corresponding transcriptome data: "all_contig_annotations", "clonotypes", "all_contig", "consensus","reference","reference_real", "transcriptome","igraph_list_iso","igraph_list_trans","Seq_Name","igraph.index.attr","history","igraph.index","selected.seq","version","parameters".</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Alexander Yermanos.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


