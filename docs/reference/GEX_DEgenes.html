<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extracts the differentially expressed genes between two groups of cells. These groups are defined as cells having either of two entries (group1, group2) in the grouping.column of the input Seurat object metadata This function uses the FindMarkers function from the Seurat package. — GEX_DEgenes • Platypus</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extracts the differentially expressed genes between two groups of cells. These groups are defined as cells having either of two entries (group1, group2) in the grouping.column of the input Seurat object metadata This function uses the FindMarkers function from the Seurat package. — GEX_DEgenes" />
<meta property="og:description" content="Extracts the differentially expressed genes between two groups of cells. These groups are defined as cells having either of two entries (group1, group2) in the grouping.column of the input Seurat object metadata This function uses the FindMarkers function from the Seurat package." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette_index.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_index.html">View all</a>
    </li>
    <li class="dropdown-header">First steps</li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/platypus_database.html">Platypus Database</a>
    </li>
    <li>
      <a href="../articles/airr_compatibility.html">AIRR compatibility and TRUST4</a>
    </li>
    <li>
      <a href="../articles/vdj_gex_integration.html">VDJ-GEX integration</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">GEX analysis using Seurat</li>
    <li>
      <a href="../articles/quality_control.html">Quality control</a>
    </li>
    <li>
      <a href="../articles/feature_barcodes.html">Feature Barcodes</a>
    </li>
    <li>
      <a href="../articles/GEX_overview.html">GEX overview</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">VDJ analysis</li>
    <li>
      <a href="../articles/clonotyping.html">Clonotyping</a>
    </li>
    <li>
      <a href="../articles/clonal_expansion.html">Clonal expansion</a>
    </li>
    <li>
      <a href="../articles/germline_genes.html">Germline gene and isotype usage</a>
    </li>
    <li>
      <a href="../articles/sampling_diversity.html">Sampling and diversity analysis</a>
    </li>
    <li>
      <a href="../articles/somatic_hypermutations.html">Somatic hypermutations</a>
    </li>
    <li>
      <a href="../articles/TCR_look_up.html">TCR look up and specificity</a>
    </li>
    <li>
      <a href="../articles/mixcr_antibody_expression.html">MiXCR and Antibody expression</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data simulation</li>
    <li>
      <a href="../articles/echidna.html">Echidna</a>
    </li>
  </ul>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://immunesim.readthedocs.io/en/latest/">ImmuneSIM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/alexyermanos">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extracts the differentially expressed genes between two groups of cells. These groups are defined as cells having either of two entries (group1, group2) in the grouping.column of the input Seurat object metadata This function uses the FindMarkers function from the Seurat package.</h1>
    <small class="dont-index">Source: <a href='https://github.com/alexyermanos/Platypus/tree/masterR/GEX_DEgenes.R'><code>R/GEX_DEgenes.R</code></a></small>
    <div class="hidden name"><code>GEX_DEgenes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extracts the differentially expressed genes between two groups of cells. These groups are defined as cells having either of two entries (group1, group2) in the grouping.column of the input Seurat object metadata This function uses the FindMarkers function from the Seurat package.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>GEX_DEgenes</span><span class='op'>(</span>
  <span class='va'>GEX</span>,
  <span class='va'>FindMarkers.out</span>,
  <span class='va'>grouping.column</span>,
  <span class='va'>group1</span>,
  <span class='va'>group2</span>,
  <span class='va'>min.pct</span>,
  <span class='va'>filter</span>,
  <span class='va'>return.plot</span>,
  <span class='va'>logFC</span>,
  <span class='va'>color.p.threshold</span>,
  <span class='va'>color.log.threshold</span>,
  <span class='va'>color.by.threshold</span>,
  <span class='va'>up.genes</span>,
  <span class='va'>down.genes</span>,
  <span class='va'>base</span>,
  <span class='va'>label.n.top.genes</span>,
  <span class='va'>genes.to.label</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>GEX</th>
      <td><p>Output Seurat object from automate_GEX or VDJ_GEX_matrix_function (VDJ_GEX_matrix.output[[2]]) function that contained at least two distinct biological groups.</p></td>
    </tr>
    <tr>
      <th>FindMarkers.out</th>
      <td><p>OPTIONAL: the output of the FindMarkers function. This skips the DEG calculation step and outputs desired plots. All plotting parameters function as normal. Grouping parameters and min.pct are ignored.</p></td>
    </tr>
    <tr>
      <th>grouping.column</th>
      <td><p>Character. A column name of GEX@meta.data. In this column, group1 and group2 should be found. Defaults to "sample_id". Could also be set to "seurat_clusters" to generate DEGs between cells of 2 chosen clusters.</p></td>
    </tr>
    <tr>
      <th>group1</th>
      <td><p>either character or integer specifying the first group of cells that should be compared. (e.g. "s1" if sample_id is used as grouping.column)</p></td>
    </tr>
    <tr>
      <th>group2</th>
      <td><p>either character or integer specifying the first group of cells that should be compared. (e.g. "s2" if sample_id is used as grouping.column)</p></td>
    </tr>
    <tr>
      <th>min.pct</th>
      <td><p>The minimum percentage of cells expressing a gene in either of the two groups to be compared.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>Character vector of initials of the genes to be filtered. Default is c("MT-", "RPL", "RPS"), which filters mitochondrial and ribosomal genes.</p></td>
    </tr>
    <tr>
      <th>return.plot</th>
      <td><p>Character specifying if a "heatmap", or a "volcano" or "none" is to be returned. If not "none" then @return is a list where the first element is a dataframe and the second a plot (see @return). Defaults to none</p></td>
    </tr>
    <tr>
      <th>logFC</th>
      <td><p>Logical specifying whether the genes will be displayed based on logFC (TRUE) or pvalue (FALSE).</p></td>
    </tr>
    <tr>
      <th>color.p.threshold</th>
      <td><p>numeric specifying the adjusted p-value threshold for geom_points to be colored. Default is set to 0.01.</p></td>
    </tr>
    <tr>
      <th>color.log.threshold</th>
      <td><p>numeric specifying the absolute logFC threshold for geom_points to be colored. Default is set to 0.25.</p></td>
    </tr>
    <tr>
      <th>color.by.threshold</th>
      <td><p>Boolean. Set to TRUE to color by color.p.threshold and color.log.threshold. Set to FALSE for a continuous color scale by fold change.</p></td>
    </tr>
    <tr>
      <th>up.genes</th>
      <td><p>FOR HEATMAP Integer specifying the number of upregulated genes to be shown.</p></td>
    </tr>
    <tr>
      <th>down.genes</th>
      <td><p>FOR HEATMAP Integer specifying the number of downregulated genes to be shown.</p></td>
    </tr>
    <tr>
      <th>base</th>
      <td><p>The base with respect to which logarithms are computed. Default: 2</p></td>
    </tr>
    <tr>
      <th>label.n.top.genes</th>
      <td><p>FOR VOLCANO Interger. How many top genes to label either by Fold change (if logFC == TRUE) or by p.value (if logFC == FALSE). More than 50 are not recommended. Also works in conjunction with genes.to.label</p></td>
    </tr>
    <tr>
      <th>genes.to.label</th>
      <td><p>FOR VOLCANO Character vector of genes to label irregardless of their p value.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list with out[[1]] = a dataframe containing the output from the FindMarkers function, which contains information regarding the genes that are differentially regulated, statistics (p value and log fold change), and the percent of cells expressing the particular gene for both groups. out[[2]] = either a "heatmap" (set return.plot accordingly), or "volcano" plot</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='co'>#Basic run between two samples</span></span>
<span class='r-in'><span class='fu'>GEX_DEgenes</span><span class='op'>(</span>GEX <span class='op'>=</span> <span class='fu'>Platypus</span><span class='fu'>::</span><span class='va'><a href='small_vgm.html'>small_vgm</a></span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>,min.pct <span class='op'>=</span> <span class='fl'>.25</span>,</span>
<span class='r-in'>group1 <span class='op'>=</span> <span class='st'>"s1"</span>,group2 <span class='op'>=</span> <span class='st'>"s2"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           p_val  avg_logFC pct.1 pct.2 p_val_adj SYMBOL signif_pval</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD83  0.1723594 -1.0511537 0.714 0.833 0.5170782   CD83       FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD24A 0.3930155 -0.8896529 0.429 0.500 1.0000000  CD24A       FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD19  0.6151259 -0.3196211 0.714 0.833 1.0000000   CD19       FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       signif_logfc color_threshold</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD83          TRUE           FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD24A         TRUE           FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> CD19          TRUE           FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> NULL</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Getting DEGs between two seurat clusters</span></span>
<span class='r-in'><span class='co'>#GEX_DEgenes(GEX = Platypus::small_vgm[[2]],min.pct = .25,</span></span>
<span class='r-in'><span class='co'>#grouping.column = "seurat_clusters",group1 = "0",group2 = "1")</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Plotting a heatmap by foldchange of sample markers</span></span>
<span class='r-in'><span class='co'>#GEX_DEgenes(GEX = VDJ_GEX_matrix.output[[2]]</span></span>
<span class='r-in'><span class='co'>#,min.pct = .25,group1 = "s1",group2 = "s2", return.plot = "heatmap"</span></span>
<span class='r-in'><span class='co'>#, up.genes = 10, down.genes = 10, logFC = TRUE)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Plotting volcano by p value of sample markers. Label additional genes of interest</span></span>
<span class='r-in'><span class='co'>#GEX_DEgenes(GEX = VDJ_GEX_matrix.output[[2]],min.pct = .25</span></span>
<span class='r-in'><span class='co'>#,group1 = "s1",group2 = "s2", return.plot = "volcano", logFC = FALSE</span></span>
<span class='r-in'><span class='co'>#, label.n.top.genes = 40, genes.to.label = c("CD28", "ICOS"))</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Generate a heatmap from an already existing FindMarkers output</span></span>
<span class='r-in'><span class='co'>#GEX_DEgenes(GEX = VDJ_GEX_matrix.output[[2]]</span></span>
<span class='r-in'><span class='co'>#, FindMarkers.out = FindMarkers.output.dataframe, return.plot = "heatmap"</span></span>
<span class='r-in'><span class='co'>#, up.genes = 10, down.genes = 10, logFC = TRUE, platypus.version = "v3")</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Alexander Yermanos.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


