<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pseudotime analysis for scRNA and repertoire sequencing datasets — VDJ_GEX_clonotyme • Platypus</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pseudotime analysis for scRNA and repertoire sequencing datasets — VDJ_GEX_clonotyme"><meta property="og:description" content="Pseudotime analysis for scRNA and repertoire sequencing datasets"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Get started</a>
</li>
<li>
  <a href="../vignette_index.html">Vignettes</a>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://immunesim.readthedocs.io/en/latest/" class="external-link">ImmuneSIM</a>
    </li>
  </ul></li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/alexyermanos" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pseudotime analysis for scRNA and repertoire sequencing datasets</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexyermanos/Platypus/tree/masterR/VDJ_GEX_clonotyme.R" class="external-link"><code>R/VDJ_GEX_clonotyme.R</code></a></small>
    <div class="hidden name"><code>VDJ_GEX_clonotyme.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Pseudotime analysis for scRNA and repertoire sequencing datasets</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">VDJ_GEX_clonotyme</span><span class="op">(</span></span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">version</span>,</span>
<span>  <span class="va">top.N.clonotypes</span>,</span>
<span>  <span class="va">vdj.gex.matrix.output</span>,</span>
<span>  <span class="va">vdj.analyze.output</span>,</span>
<span>  <span class="va">gex.automate.output</span>,</span>
<span>  <span class="va">exclude.clusters</span>,</span>
<span>  <span class="va">colors</span>,</span>
<span>  <span class="va">show.cells</span>,</span>
<span>  <span class="va">highlight.genes</span>,</span>
<span>  <span class="va">dropest.output.list</span>,</span>
<span>  <span class="va">velocyto.gex.merged</span>,</span>
<span>  <span class="va">velocyto.file.name</span>,</span>
<span>  <span class="va">velocyto.out.dir</span>,</span>
<span>  <span class="va">velocyto.save.rds</span>,</span>
<span>  <span class="va">velocyto.norm.scale.factor</span>,</span>
<span>  <span class="va">velocyto.n.variable.features</span>,</span>
<span>  <span class="va">velocyto.neighbor.dim</span>,</span>
<span>  <span class="va">velocyto.cluster.resolution</span>,</span>
<span>  <span class="va">velocyto.mds.dim</span>,</span>
<span>  <span class="va">velocyto.nCount_spliced</span>,</span>
<span>  <span class="va">velocyto.percent.mt</span>,</span>
<span>  <span class="va">velocyto.normalisation.method</span>,</span>
<span>  <span class="va">velocyto.selection.method</span>,</span>
<span>  <span class="va">velocyto.deltaT</span>,</span>
<span>  <span class="va">velocyto.kCells</span>,</span>
<span>  <span class="va">velocyto.fit.quantile</span>,</span>
<span>  <span class="va">velocyto.kGenes</span>,</span>
<span>  <span class="va">root.selection</span>,</span>
<span>  <span class="va">root.marker</span>,</span>
<span>  <span class="va">ridgeline.separator</span>,</span>
<span>  <span class="va">genes.for.module.score</span>,</span>
<span>  <span class="va">root.nodes</span>,</span>
<span>  <span class="va">color.cells</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>method</dt>
<dd><p>Pseudotime analylysis method to be used. Possible parameters are monocle3 or velocyto. monocle3 is being used as a default method. For velocyto analysis please run on Cluster and it is only available for UNIX based systems.</p></dd>


<dt>version</dt>
<dd><p>Platypus version to use "v2" or "v3". version 2 used by default.</p></dd>


<dt>top.N.clonotypes</dt>
<dd><p>How many clonotypes to show per sample in the Ridgeline plots and on the Velocyto UMAP.</p></dd>


<dt>vdj.gex.matrix.output</dt>
<dd><p>If Platypus v3 is used, the input to this function has to be the output of the VDJ_GEX_matrix function.</p></dd>


<dt>vdj.analyze.output</dt>
<dd><p>If Platypus v2 is used, the VDJ_analyze output has to be supplied.</p></dd>


<dt>gex.automate.output</dt>
<dd><p>If Platypus v2 is used, the GEX_automate output has to be supplied here.</p></dd>


<dt>exclude.clusters</dt>
<dd><p>Please enter a cluster number if you'd like to exclude a certain cluster from analysis. Cluster will be assigned to different partition in Monocle3 analysis and therefore pseudotime distance will be set to infinity. Cells from this cluster will be deleted from the dataset in the Velocyto analysis.</p></dd>


<dt>colors</dt>
<dd><p>Vector containing custom colors to be used for highlighting the clonotypes. If left empty, default colors will be assigned.</p></dd>


<dt>show.cells</dt>
<dd><p>Logical, should cells be shown in the Ridgeline plots. True by default.</p></dd>


<dt>highlight.genes</dt>
<dd><p>Vector containing gene names. The expressionlevels of these genes along pseudotime will be plotted.</p></dd>


<dt>dropest.output.list</dt>
<dd><p>List containing the cell.counts.matrices.rds from the Dropest alignment for Velocyto analysis.</p></dd>


<dt>velocyto.gex.merged</dt>
<dd><p>Logical whether samples should be shown in combined UMAP or sepeartely.</p></dd>


<dt>velocyto.file.name</dt>
<dd><p>String used as file name when saving the output pdf</p></dd>


<dt>velocyto.out.dir</dt>
<dd><p>Directory to save the output files. By default the current working directory.</p></dd>


<dt>velocyto.save.rds</dt>
<dd><p>If RDS objects should be saved as well. Default = F.</p></dd>


<dt>velocyto.norm.scale.factor</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.n.variable.features</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.neighbor.dim</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.cluster.resolution</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.mds.dim</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.nCount_spliced</dt>
<dd><p>Cutoff threshold. cells with less spliced gene counts will be omitted. Filtering of bad quality cells.</p></dd>


<dt>velocyto.percent.mt</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.normalisation.method</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.selection.method</dt>
<dd><p>Parameter for GEX analysis of the cell.count.matrices.</p></dd>


<dt>velocyto.deltaT</dt>
<dd><p>Parameter for Velocyto analysis</p></dd>


<dt>velocyto.kCells</dt>
<dd><p>Parameter for Velocyto analysis</p></dd>


<dt>velocyto.fit.quantile</dt>
<dd><p>Parameter for Velocyto analysis</p></dd>


<dt>velocyto.kGenes</dt>
<dd><p>Parameter for Velocyto analysis</p></dd>


<dt>root.selection</dt>
<dd><p>Character. Method for root selection. Defaults to "manual"</p></dd>


<dt>root.marker</dt>
<dd><p>Character. Marker to use as Root. Defaults to "SELL"</p></dd>


<dt>ridgeline.separator</dt>
<dd><p>Character. Variable to group ridgeline plots by. Defaults to "clonotype"</p></dd>


<dt>genes.for.module.score</dt>
<dd><p>List of vectors of genes. With module scores inferred via Seurat::AddModuleScore(). Default is set to NULL.</p></dd>


<dt>root.nodes</dt>
<dd><p>Labeled node from trajectory plot to specify root nodes root nodes for pseudotime trajectory.</p></dd>


<dt>color.cells</dt>
<dd><p>For the module score plot decide how the cells should be coloured (based on e.g. group_id, seurat_clusters etc.). Default = 'seurat_clusters'</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If method=monocle3, the function returns a list element: [[1]] UMAP colored by Pseudotime, [[2]] Ridgeline plots showing the density of each of the top.N.clonotypes per cluster along pseudotime., [[3]] Gene expression plots highlighting the gene expression across pseudotime colored by transcriptional cluster, [[4]] Gene expression plots highlighting the gene expression across pseudotime colored by colotype. If method=velocyto, plots and RDS will be saved to velocyto.out.dir.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Yermanos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

