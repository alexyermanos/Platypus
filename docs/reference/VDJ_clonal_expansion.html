<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Flexible wrapper for clonal expansion barplots by isotype, GEX cluster etc. — VDJ_clonal_expansion • Platypus</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Flexible wrapper for clonal expansion barplots by isotype, GEX cluster etc. — VDJ_clonal_expansion"><meta property="og:description" content='Clonal frequency plot displaying clonal expansion for either T and B cells with Platypus v3 input. Only available for Platypus "v3" available. For v2 plotting of B cell clonotype expansion and isotypes please refer to VDJ_isotypes_per_clone.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Platypus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Get started</a>
</li>
<li>
  <a href="../vignette_index.html">Vignettes</a>
</li>
<li>
  <a href="../PlatypusDB_index.html">PlatypusDB</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://immunesim.readthedocs.io/en/latest/" class="external-link">ImmuneSIM</a>
    </li>
  </ul></li>
<li>
  <a href="../cute_monotremes.html">Cute Monotremes</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/alexyermanos" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/KreineVic" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/alexyermanos/Platypus" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flexible wrapper for clonal expansion barplots by isotype, GEX cluster etc.</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexyermanos/Platypus/tree/masterR/VDJ_clonal_expansion.R" class="external-link"><code>R/VDJ_clonal_expansion.R</code></a></small>
    <div class="hidden name"><code>VDJ_clonal_expansion.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clonal frequency plot displaying clonal expansion for either T and B cells with Platypus v3 input. Only available for Platypus "v3" available. For v2 plotting of B cell clonotype expansion and isotypes please refer to VDJ_isotypes_per_clone.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">VDJ_clonal_expansion</span><span class="op">(</span></span>
<span>  <span class="va">VDJ</span>,</span>
<span>  <span class="va">celltype</span>,</span>
<span>  <span class="va">clones</span>,</span>
<span>  <span class="va">subtypes</span>,</span>
<span>  <span class="va">isotypes.to.plot</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  <span class="va">treat.incomplete.clones</span>,</span>
<span>  <span class="va">treat.incomplete.cells</span>,</span>
<span>  <span class="va">group.by</span>,</span>
<span>  <span class="va">color.by</span>,</span>
<span>  <span class="va">variant.plot</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>VDJ</dt>
<dd><p>VDJ dataframe generated using the VDJ_GEX_matrix function (VDJ_GEX_matrix.output[[1]])</p></dd>


<dt>celltype</dt>
<dd><p>Character. Either "Tcells" or "Bcells". If set to Tcells bars will not be colored by default and the parameters treat_incomplete_cells, treat_incomplete_clones, subtypes and species are ignored. The color.by and group.by arguments work identically for both celltypes. If none provided it will detect this param from the celltype column.</p></dd>


<dt>clones</dt>
<dd><p>numeric value indicating the number of clones to be considered for the clonal expansion plot. Default value is 50. For a standard plot more than 50 is discouraged. When showing only one - possibly rare - isotype via isotypes.to.plot it may be useful to set this number higher (e.g. 100-200)</p></dd>


<dt>subtypes</dt>
<dd><p>Logical indicating whether to display isotype subtypes or not.</p></dd>


<dt>isotypes.to.plot</dt>
<dd><p>Character vector. Defaults to "all". This can be set to any number of specific Isotypes, that are to be shown exclusively. For example, to show only clones containing IgG, input "IGHG". If only wanting to check clones with IgA and IgD input c("IGHA","IGHD"). Works equally if subtypes are set to TRUE. Is ignored if color.by is not set to "isotype"</p></dd>


<dt>species</dt>
<dd><p>Character indicating whether the samples are from "Mouse" or "Human". Default is "Human".</p></dd>


<dt>treat.incomplete.clones</dt>
<dd><p>Character indicating how to proceed with clonotypes lacking a VDJC (in other words, no cell within the clonotype has a VDJC). "exclude" removes these clonotypes from the analysis. "include" keeps these clonotypes in the analysis. In the plot they will appear has having an unknown isotype.</p></dd>


<dt>treat.incomplete.cells</dt>
<dd><p>Character indicating how to proceed with cells assigned to a clonotype but missing a VDJC. "proportional" to fill in the VDJ isotype according to the proportions present in of clonotype (in case present proportions are not replicable in the total number of cells e.g. 1/3 in 10 cells, values are rounded to the next full integer and if the new counts exceed the total number of cells, 1 is subtracted from the isotype of highest frequency. If the number is below the number of cell, 1 is added to the isotype with lowest frequency to preserve diversity), "exclude" to exclude them from analysis and rank clonotypes only by the number of cells with a heavy chain. This ranking may deviate from the frequency column in the clonotype table. CAVE: if treat_incomplete_cells is set to "exclude", clonotypes lacking a VDJC entierly will be removed from the analysis. This results in a similar but not identical output as when treat_incomplete_clones is set to true. The two parameters are thereby non-redundant.</p></dd>


<dt>group.by</dt>
<dd><p>Character. Defaults to "sample_id". Column name of VDJ to split VDJ by. For each unique entry in that column a plot will be generated. Therefore plots can be generated by sample_id, group_id or any other metadata item.To get plots for the whole repertoire set to "none"</p></dd>


<dt>color.by</dt>
<dd><p>Character. Defaults to "isotype". If set to "isotype" bars are colored by the respective IgH chain or in grey for T cells. This can alternatively be set to any column name of the VDJ. This allows coloring clones by their V_gene usage or by GEX clusters</p></dd>


<dt>variant.plot</dt>
<dd><p>Logical indicating whether to plot the output showing the variants or not.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a nested list. out[[1]] are plots out[[2]] are raw datatables containing also barcode and CDR3 information</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Standard B cell plot for platypus version v3</span></span></span>
<span class="r-in"><span><span class="co">#Will generate one plot per sample (from sample_id column)</span></span></span>
<span class="r-in"><span><span class="va">clonal_out</span> <span class="op">&lt;-</span> <span class="fu">VDJ_clonal_expansion</span><span class="op">(</span>VDJ <span class="op">=</span> <span class="fu">Platypus</span><span class="fu">::</span><span class="va"><a href="small_vgm.html">small_vgm</a></span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span> celltype <span class="op">=</span> <span class="st">"Bcells"</span>, clones <span class="op">=</span> <span class="fl">30</span>,subtypes <span class="op">=</span> <span class="cn">FALSE</span>, species <span class="op">=</span> <span class="st">"Mouse"</span></span></span>
<span class="r-in"><span> ,treat.incomplete.clones <span class="op">=</span> <span class="st">"exclude"</span></span></span>
<span class="r-in"><span> ,treat.incomplete.cells <span class="op">=</span> <span class="st">"proportional"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Regrouped and recolored plot in v3</span></span></span>
<span class="r-in"><span><span class="co">#Will generate a plot for each sample.</span></span></span>
<span class="r-in"><span><span class="co">#Bars are filled by the sample with the highest proportion of cells in a given clonotype</span></span></span>
<span class="r-in"><span><span class="va">clonal_out</span> <span class="op">&lt;-</span> <span class="fu">VDJ_clonal_expansion</span><span class="op">(</span>VDJ <span class="op">=</span> <span class="fu">Platypus</span><span class="fu">::</span><span class="va"><a href="small_vgm.html">small_vgm</a></span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>, celltype <span class="op">=</span> <span class="st">"Bcells"</span>, clones <span class="op">=</span> <span class="fl">30</span>,subtypes <span class="op">=</span> <span class="cn">FALSE</span>, species <span class="op">=</span> <span class="st">"Mouse"</span></span></span>
<span class="r-in"><span>,treat.incomplete.clones <span class="op">=</span> <span class="st">"exclude"</span></span></span>
<span class="r-in"><span>,treat.incomplete.cells <span class="op">=</span> <span class="st">"proportional"</span></span></span>
<span class="r-in"><span>,color.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span> <span class="co">#change grouping with group.by = "column name"</span></span></span>
<span class="r-in"><span><span class="va">clonal_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co">#list of plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="VDJ_clonal_expansion-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="VDJ_clonal_expansion-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="VDJ_clonal_expansion-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">clonal_out</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co">#list of source dataframes</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $s1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Counts Color ClonalRank  clonotype_id         VDJ_cdr3s_aa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1  None          1 clonotype1243             CVRSWDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1     0          2 clonotype1364          CARWNWYFDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1     2          3 clonotype1451         CARDYYGSSGYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       1     3          4 clonotype1514         CARTTGAWFAYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       1  None          5 clonotype1682        CARGKNGAWFAYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1  None          6 clonotype1725         CARVNLHAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       1     1          7 clonotype1923     CARNGYYYGSSTFDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       1  None          8 clonotype2040     CVRGGYDYDRDYFDFW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       1  None          9 clonotype2053     CARSSLYYGNFYFDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      1  None         10 clonotype2069       CARWVYQTRAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1     0         11 clonotype2100     CARDYYGSSLRYFDVW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      1     0         12 clonotype2271   CTFRIYYYGSSPYYFDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      1     3         13 clonotype2276   CTRREIYDGLSYYAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      1  None         14 clonotype2287   CARPPYYYGSSPYAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      1     0         15 clonotype2295     CVRQNYGSSHWYFDVW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      1  None         16 clonotype2368  CARIAFPAYYSNYRGFAYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      1  None         17 clonotype2386 CTRNMRLRRGTGTGYAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                VJ_cdr3s_aa               barcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              CQQYNSYPLTF s1_CTACGTCCAAAGGCGT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              CSQSTHVPWTF s1_TAGTGGTCAAGCGATG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              CALWYSNHLVF s1_AGACGTTTCCACGTGG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          CGVGDTIKEQFVYVF s1_GGGAATGCAGTGGAGT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              CWQGTHFPLTF s1_TACTTGTCACCAGGCT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6              CQHFWGTPRTF s1_GCTGGGTGTCCAGTTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7              CQQSNSWPLTF s1_TAAACCGAGCGCTCCA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8              CAQNLELPYTF s1_ACGATGTTCAAACCGT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9                     &lt;NA&gt; s1_CCCAGTTAGCAGGTCA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 CQQGQSYPLTF;CQQGDTLPWTF s1_CCAATCCTCTGCAGTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11             CKQAYDVPYTF s1_AAGGCAGTCGATCCCT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12             CQQHYSTPFTF s1_GATCGATAGTTAGCGG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 CQQDYSSPWTF;CLQYASSPWTF s1_TTAACTCCAACCGCCA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14             CQQHYSTPLTF s1_TCTCATAGTGTTGAGG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15             CQQWSSNPPTF s1_CAACCTCTCTCCAGGG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16             CQNDYSYPLTF s1_CAGAATCAGCAATCTC-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17             CLQYDNLLWTF s1_CGTTGGGAGGGATCTG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $s2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Counts Color ClonalRank clonotype_id                  VDJ_cdr3s_aa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1     0          1 clonotype516 CARNRITTVVAPMDYW;CARKDYARGDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1     2          2 clonotype634                  CARPPLTGFAYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1  None          3 clonotype635                 CARKSSHWYFDVW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1     4          4 clonotype649                CASGGGNPWYFDVW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1     2          5 clonotype686                CTRGRRPEGYFDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1  None          6 clonotype734               CARCGYYGYHAMDYW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               VJ_cdr3s_aa               barcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 CQQSNSWPLTF;CQQGSSIPLTF s2_AGGTCATTCTTGGGTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              CHQYLSSWTF s2_CTACCCAAGACTAGAT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             CQQHLHIPRTF s2_CCTCTGACAGACGCAA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             CQQHYSTPYTF s2_CCTCTGACACCAGATT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             CQQGSSIPLTF s2_TACGGATGTGGGTCAA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             CALWYSTRYVF s2_GACCAATTCTTCATGT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $s3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Counts Color ClonalRank  clonotype_id       VDJ_cdr3s_aa  VJ_cdr3s_aa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1     1          1 clonotype1028  CAREGYYGSSPYAMDYW   CLQYDNLFTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1     3          2 clonotype1056 CARKTEGVYYGNYVFDYW  CQQSKEVPPTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1     0          3  clonotype141 CARWGIYDGYYGDAMDYW  CALWYSNHLVF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       1  None          4  clonotype390           CARTFAYW  CLQYASSPWTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       1     1          5  clonotype464         CARMVTGAYW  CQNDYSYPLTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1  None          6  clonotype478        CARWDVYFDYW  CQQGNTLPRTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       1     2          7  clonotype592       CAREATVVADYW  CQQSNEDPRTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       1     3          8  clonotype649     CARPNSLDWYFDVW  CALWYSNHFIF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       1  None          9  clonotype777     CARGGVTTGEFAYW  CQQYWSTPFTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      1     3         10  clonotype897    CARPLTGTSGAMDYW CQHFWSTPPWTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1     0         11  clonotype921    CARKRDYDSYAMDYW  CQQSNEDPWTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  barcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  s3_TGGGCGTTCGGTTCGG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  s3_CCCAGTTCACTCGACG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  s3_ATGCGATTCCCATTAT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  s3_AGCGTATCACGGACAA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  s3_GTGCGGTAGCCCAGCT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  s3_CAGAATCGTTATCCGA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  s3_ATTATCCAGTTCGATC-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  s3_TCTTCGGGTGCTCTTC-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  s3_GCTCCTACAGAGTGTG-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 s3_TCTCTAACATGGTCTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 s3_GGTGCGTTCGGCCGAT-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#T cell plot with recoloring by vgene</span></span></span>
<span class="r-in"><span><span class="co">#VDJ_clonal_expansion(VDJ = Platypus::small_vgm[[1]]</span></span></span>
<span class="r-in"><span><span class="co">#,celltype = "Tcells", clones = 30, group.by = "sample_id"</span></span></span>
<span class="r-in"><span><span class="co">#,color_by = "VDJ_vgene")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plotting only IgD clones. Increased the value for clones to scan more of the dataset</span></span></span>
<span class="r-in"><span><span class="co">#VDJ_clonal_expansion(VDJ = Platypus::small_vgm[[1]]</span></span></span>
<span class="r-in"><span><span class="co">#,celltype = "Bcells", clones = 150,subtypes = FALSE</span></span></span>
<span class="r-in"><span><span class="co">#,species = "Mouse",treat.incomplete.clones = "include"</span></span></span>
<span class="r-in"><span><span class="co">#,treat.incomplete.cells = "proportional", isotypes.to.plot = "IGHD")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plotting only clones containing cells with the IGHG2c isotype (For murine data only!)</span></span></span>
<span class="r-in"><span><span class="co">#VDJ_clonal_expansion(VDJ = Platypus::small_vgm[[1]]</span></span></span>
<span class="r-in"><span><span class="co">#,celltype = "Bcells", clones = 150,subtypes = TRUE, species = "Mouse"</span></span></span>
<span class="r-in"><span><span class="co">#,treat.incomplete.clones = "exclude"</span></span></span>
<span class="r-in"><span><span class="co">#,treat.incomplete.cells = "proportional", isotypes.to.plot = "IGHG2c")</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Yermanos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

